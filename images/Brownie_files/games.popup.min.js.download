window.popup_utility=function(){return this.host=null,this.proxy_frame=null,this.ready_callbacks=[],this.game_ready_callbacks=[],this.callback_increment=0,this.callback_storage={},this.cookie_data={},this.logs=[],this.post_history=[],this.userAgent=navigator.userAgent.toLowerCase(),this.devices={ipad:!1,iphone:!1,android:!1,android_tablet:!1,android_phone:!1,windows_phone:!1,mobile:!1,desktop:!1,tablet:!1,iOSversion:0},this.getCookie=function(e,t){this.callMethod("getCookie",[e],t)},this.deleteCookie=function(e,t){this.callMethod("deleteCookie",[e],t)},this.createCookie=function(e,t,i,s,o,a){this.callMethod("createCookie",[e,t,i,s,o],a)},this.setStorage=function(e,t,i){this.callMethod("setStorage",[e,t,i],callback)},this.checkConditions=function(c,e,t,i){if(void 0===i&&(i=!0),(t=t||{}).active=void 0!==t.active&&t.active,t.devices=void 0!==t.devices?t.devices:null,t.schedule=void 0!==t.schedule?t.schedule:null,t.ignore_urls=void 0!==t.ignore_urls?t.ignore_urls:null,t.default_display=void 0!==t.default_display?t.default_display:"show",t.rules=void 0!==t.rules?t.rules:null,this.info(c+")","(Conditions check) using:",t),!t.active)return this.error(c+")","(Conditions check) hide due to active flag being false"),!1;if(t.devices){var s=!1;if(this.devices.windows_phone||this.devices.android||this.devices.ipad||this.devices.iphone||1!=t.devices.desktop?(this.devices.windows_phone||this.devices.android_phone||this.devices.iphone)&&1==t.devices.mobile?s=!0:(this.devices.android_tablet||this.devices.ipad)&&1==t.devices.tablet&&(s=!0):s=!0,!s)return this.error(c+")","(Conditions check) failed on devices check, found:",this.devices,"but expected",t.devices),!1}var o;if(t.ignore_urls&&0<t.ignore_urls.length)for(var a in t.ignore_urls)if(t.ignore_urls.hasOwnProperty(a)){o=t.ignore_urls[a];var n=this.getUrl(o),r=this.getRegex(o);if(!0===r.test(n))return this.error(c+")","(Conditions check) failed on ignore urls check, testing on: '"+n+"' using regex:",r),!1}if(t.schedule&&1==t.schedule.active&&void 0!==t.schedule.days&&7===t.schedule.days.length){var h=60*(new Date).getHours()+(new Date).getMinutes(),l=t.schedule.days[[1,2,3,4,5,6,0].indexOf(parseInt((new Date).getDay(),10))];if("1"!=l.active)return this.error(c+")","(Conditions check) failed on schedule check due to active not set - on item:",l),!1;if("00:00"!=l.start&&"00:00"!=l.end){var d=l.start.split(":"),u=60*parseInt(d[0],10)+parseInt(d[1],10),g=l.end.split(":"),p=parseInt(g[0],10),f=parseInt(g[1],10);if(!(u<=h&&h<=60*p+f))return this.error(c+")","(Conditions check) failed on schedule check, on item:",l),!1}}var v="show"===t.default_display;if(t.rules&&null!==t.rules){if(!t.rules.length){var _=[];for(var w in t.rules)t.rules.hasOwnProperty(w)&&_.push(t.rules[w]);t.rules=_}var m={};try{t.rules.forEach(function(e){var t,i;if(e.rule&&""!==e.rule)switch(e.rule.toLowerCase()){case"url":if(e.settings&&e.settings.url&&""!==e.settings.url){var s=this.getUrl(e.settings.url);if(!0===(i=this.getRegex(e.settings.url)).test(s)){if(!(v="show"===e.action))throw this.error(c+")","(Conditions check) failed on url rule check using rule:",e,", regex:",i,"& test_on:",s),m;this.success(c+")","(Conditions check) successfully matched url rule:",e,", regex:",i,"& test_on:",s)}}break;case"utm":if(e.settings&&e.settings.source&&""!==e.settings.source&&e.settings.name&&""!==e.settings.name&&-1!==window.location.href.indexOf("?")){t="&"+window.location.href.substr(window.location.href.indexOf("?")+1).toLowerCase()+"&";var o=this.getRegex("utm_campaign="+e.settings.name.toLowerCase(),"parameter"),a=this.getRegex("utm_source="+e.settings.source.toLowerCase(),"parameter");if(!0===o.test(t)&&!0===a.test(t))throw(v="show"===e.action)?this.success(c+")","(Conditions check) successfully matched utm rule:",e,", regex_campaign:",o,", regex_source:",a,"& test_on:",t):this.error(c+")","(Conditions check) failed on utm rule:",e,", regex_campaign:",o,", regex_source:",a,"& test_on:",t),m}break;case"parameter":if(e.settings&&e.settings.parameter&&""!==e.settings.parameter&&-1!==window.location.href.indexOf("?")&&(t="&"+window.location.href.substr(window.location.href.indexOf("?")+1)+"&",!0===(i=this.getRegex(e.settings.parameter.toLowerCase(),"parameter")).test(t)))throw(v="show"===e.action)?this.success(c+")","(Conditions check) successfully matched parameter rule:",e,", regex:",i,"& after_parameters:",t):this.error(c+")","(Conditions check) failed on parameter rule:",e,", regex:",i,"& after_parameters:",t),m;break;case"cookie":if(e.settings&&e.settings.name&&""!==e.settings.name&&e.settings.value&&""!==e.settings.value){var n=this.readCookie(e.settings.name);if(null===n&&void 0!==this.cookie_data[e.settings.name]&&(n=this.cookie_data[e.settings.name]),null!==n&&(n==e.settings.value||this.wildCardCheck(n,e.settings.value)))throw(v="show"===e.action)?this.success(c+")","(Conditions check) successfully matched cookie rule:",e,"& cookie_value:",n):this.error(c+")","(Conditions check) failed on cookie rule:",e,"& cookie_value:",n),m}break;case"hashtag":if(e.settings&&e.settings.hashtag&&""!==e.settings.hashtag){var r=""!==window.location.hash?window.location.hash.substr(1):"";if(""!==r&&(r==e.settings.hashtag||this.wildCardCheck(r,e.settings.hashtag)))throw(v="show"===e.action)?this.success(c+")","(Conditions check) successfully matched hashtag rule:",e,"& hashtag:",r):this.error(c+")","(Conditions check) failed on hashtag rule:",e,"& hashtag:",r),m}}}.bind(this))}catch(e){if(e!==m)throw e}}if(v){var y=e.display_count||0;y=parseInt(y,10),y++;var k=parseInt(t.show_count,10),b=parseInt(t.time_interval_visits,10),x=parseInt(e.last_seen||0,10);if(isNaN(b)&&(b=0),0!==x&&0!==b&&(new Date).getTime()>=x+36e5*b&&(y=1),!isNaN(k)&&1<=k&&k<y)return this.error(c+")","(Conditions check) failed due to exceeding show count","(display_count: "+y+")","(last_seen: "+x+")"),!1;i?(this.callMethod("setStorage",[c,"display_count",y],null),this.callMethod("setStorage",[c,"last_seen",x],null)):(e.display_count=y,e.last_seen=(new Date).getTime())}return v},this.wildCardCheck=function(e,t){return-1!==(t+"").indexOf("*")&&!0===this.getRegex(t,"absolute").test(e)},this.readCookie=function(e){for(var t=e+"=",i=document.cookie.split(";"),s=0,o=i.length;s<o;s++){for(var a=i[s];" "==a.charAt(0);)a=a.substring(1,a.length);if(0===a.indexOf(t))return a.substring(t.length,a.length)}return null},this.ready=function(){this.buildProxy()},this.buildProxy=function(){null===document.getElementById("leadfamly-proxy")&&(this.proxy_frame=document.createElement("iframe"),this.proxy_frame.id="leadfamly-proxy",this.proxy_frame.src=this.host+"/campaign/iframe.htm?r="+Math.floor(Math.floor((new Date).getTime()/1e3)/86400),this.proxy_frame.style.cssText=["display: block;","position: absolute;","left: -1px;","top: -1px;","width: 1px;","height: 1px;","visibility: hidden;","opacity: 0;","border: none;"].join(""),document.body.appendChild(this.proxy_frame))},this.getUrl=function(e){var t="http"===e.toLowerCase().substr(0,4),i="/"===e.substr(0,1),s="";return t?s=window.location.href:i&&(s=window.location.href.replace(window.location.origin,"")),s},this.getRegex=function(e,t){return t=t||"absolute",new RegExp(("absolute"===t?"^":"&")+e.replace(/\*/gi,"#WILDCARD#").replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&").replace(/\#WILDCARD\#/gi,".*")+("absolute"===t?"$":"&"),"i")},this.onMessage=function(e){if("message"==e.type){if("leadfamly-game-ready"===e.data){if(0<this.game_ready_callbacks.length){for(var t in this.game_ready_callbacks)this.game_ready_callbacks.hasOwnProperty(t)&&this.game_ready_callbacks[t]();this.game_ready_callbacks=[]}return}var i={};try{i=JSON.parse(e.data)}catch(e){}if(null!==i&&void 0!==i.isLeadfamly){var s=i.action,o=i.data;if("ready"==s){if(void 0!==o.cookies&&(this.cookie_data=o.cookies),this.sendMessage("ready"),0<this.ready_callbacks.length)for(var a in this.ready_callbacks)this.ready_callbacks.hasOwnProperty(a)&&this.ready_callbacks[a]();this.ready_callbacks=[]}else"response"==s&&void 0!==o.callback&&void 0!==this.callback_storage[o.callback]&&null!==this.callback_storage[o.callback]&&(this.callback_storage[o.callback](o.response),delete this.callback_storage[o.callback])}}},this.sendMessage=function(e,t){e=e||"",t=t||{},this.proxy_frame.contentWindow.postMessage(JSON.stringify({action:e,data:t,isPopup:!0}),"*")},this.callMethod=function(e,t,i){this.callback_increment++,this.callback_storage[this.callback_increment]=i,this.sendMessage("method",{name:e,args:t,callback:this.callback_increment})},this.fetchJson=function(e,t){this.get(e,{},t)},this.get=function(e,t,i){var s="undefined"!=typeof XDomainRequest?new XDomainRequest:new XMLHttpRequest;s.onload=function(){var t={};try{t=JSON.parse(s.responseText)}catch(e){t=null}i(t)},t&&0<Object.keys(t).length&&(e+="?"+this.serialize(t)),s.open("GET",e),s.send()},this.post=function(e,t,i,s){null!==(s=s||null)&&this.addPostHistory(e,t,s);var o="undefined"!=typeof XDomainRequest?new XDomainRequest:new XMLHttpRequest;o.onload=function(){var t={};try{t=JSON.parse(o.responseText)}catch(e){t=null}i(t)},o.open("POST",e),o.setRequestHeader("Content-type","application/x-www-form-urlencoded"),o.send(this.serialize(t||{}))},this.addPostHistory=function(e,t,i){this.post_history.push({url:e,parameters:t,alias:i})},this.getPostHistory=function(e){if(0<this.post_history.length)for(var t in this.post_history)if(this.post_history.hasOwnProperty(t)&&this.post_history[t].alias===e)return this.post_history[t];return null},this.serialize=function(e){var t=[];for(var i in e)e.hasOwnProperty(i)&&t.push(encodeURIComponent(i)+"="+encodeURIComponent(e[i]));return t.join("&")},this.clearStorage=function(){this.callMethod("deleteCookie",["storage_db"],null),this.callMethod("deleteCookie",["campaigns"],null),this.callMethod("deleteCookie",["hideandseek"],null),this.callMethod("deleteCookie",["force_show"],null)},this.fetchDeviceInformation=function(){this.devices.windows_phone=this.userAgent.match(/windows phone/i),this.devices.ipad=this.userAgent.match(/ipad/i)&&!this.devices.windows_phone,this.devices.iphone=(this.userAgent.match(/iphone/i)||this.userAgent.match(/ipod/i))&&!this.devices.windows_phone,this.devices.android=this.userAgent.match(/android/i)&&!this.devices.windows_phone,this.devices.android&&(-1!==this.userAgent.indexOf("mobile")?this.devices.android_phone=!0:this.devices.android_tablet=!0),(this.devices.ipad||this.devices.iphone)&&(this.devices.iOSversion=window.Number(this.userAgent.substr(this.userAgent.indexOf("os ")+3,3).replace("_","."))),this.devices.ipad||this.devices.android_tablet?this.devices.tablet=!0:this.devices.android_phone||this.devices.iphone||this.devices.windows_phone?this.devices.mobile=!0:this.devices.desktop=!0},this.dateParse=function(e){e=e.split("-");var t=parseInt(e[0],10),i=parseInt(e[1],10),s=parseInt(e[2],10);return new Date(t,i-1,s,0,0,0,0)},this.dateNow=function(){var e=new Date;return new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0)},this.registerReadyCallback=function(e){this.ready_callbacks.push(e)},this.registerGameReadyCallback=function(e){this.game_ready_callbacks.push(e)},this.init=function(e,t){this.host=e,t&&this.registerReadyCallback(t);try{window.addEventListener("message",this.onMessage.bind(this),!1),"complete"===document.readyState||"interactive"===document.readyState?this.ready():document.addEventListener("DOMContentLoaded",function(){this.ready()}.bind(this))}catch(e){console.log(e)}},this.info=function(){var e=Array.prototype.slice.call(arguments);0<e.length&&(e.unshift("color: black; background-color: turquoise; padding: 3px 5px;"),e.unshift("%c[Info]"),this.logs.push(e))},this.error=function(){var e=Array.prototype.slice.call(arguments);0<e.length&&(e.unshift("color: red; background-color: black; padding: 3px 5px;"),e.unshift("%c[Error]"),this.logs.push(e))},this.success=function(){var e=Array.prototype.slice.call(arguments);0<e.length&&(e.unshift("color: white; background-color: limeGreen; padding: 3px 5px;"),e.unshift("%c[Success]"),this.logs.push(e))},this.debug=function(){this.logs.forEach(function(e){console.log.apply(console.log,e)})},this.fetchDeviceInformation(),this},window.popup_utility=new window.popup_utility;
!function(d){var f=(new Date).getTime(),t=document.getElementById("leadfamly-games-popup-jssdk"),u="popup__",g="section",c="";if(t){var i=t.src;c=(c=i.match(new RegExp("https?://[^/]*")))[0]}function n(){var t=parseInt(window.pageYOffset||document.documentElement.scrollTop,10);return isNaN(t)?0:t}function l(t){return"string"===(typeof t).toLowerCase()&&"#"!=t[0]&&-1===t.indexOf("rgb")?"#"+t:t}var s=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame,e=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame;if(!s){var a=0;s=function(t,i){var e=(new Date).getTime(),s=Math.max(0,16-(e-a)),n=window.setTimeout(function(){t(e+s)},s);return a=e+s,n}}e||(e=function(t){clearTimeout(t)});var o=function(){for(var t=3,i=document.createElement("div"),e=i.getElementsByTagName("i");i.innerHTML="\x3c!--[if gt IE "+ ++t+"]><i></i><![endif]--\x3e",e[0];);return 4<t?t:void 0}();function v(){var t,i={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(t in i)if(i.hasOwnProperty(t)&&void 0!==document.documentElement.style[t])return i[t];return null}function r(t){return-1===t.indexOf("http://")&&-1===t.indexOf("https://")&&(t="http://"+t),-1!==t.indexOf("/campaign/view")&&-1===t.indexOf("dontbreakout")&&(-1!==t.indexOf("?")?t+="&iframe=dontbreakout":t+="?iframe=dontbreakout"),t}function h(t,i,e,s,n){this.customer_id=t,this.campaign_id=i,this.storage=e,this.data=s,this.conditions=s,this.sectionIndex=-1,this.disableNextSection=!1,this.formularDidSubmit=!1,this.didClose=!1,this.onNextSectionHandler=null,this.firedGaPageview=!1,this.sections=[],this.popup=n,this.utility=this.popup.utility,this.popup.info(this.campaign_id+")","storage:",this.storage),this.popup.info(this.campaign_id+")","data:",this.data),this.destroy=this.destroy.bind(this)}function p(t,i,e,s){this.utility=e.utility,this.scrollY=n(),this.campaign=e,this.id=t,this.data=i,this.index=s,this.isTeaser=this.campaign.data.sections[0].id==t&&(3===this.campaign.data.sections.length||5===this.campaign.data.sections.length)&&!this.campaign.data.sections[1].config.hidden,this.frame=null,this.frameWindow=null,this.frameDocument=null,this.frameContainer=null,this.frameLoading=!1,this.frameLoadingCallback=[],this.firedGaEvent=!1,this.actionTimer=null,this.directives=[{alias:"anchor",selector:"a,button.btn",directive:L},{alias:"registration",selector:"registration",directive:w},{alias:"raptor",selector:"raptor",directive:z},{alias:"iframe-element",selector:"iframe-element",directive:_},{alias:"hideandseek",selector:"hideandseek",directive:b},{alias:"iframe-games",selector:"iframe-games",directive:y}],this.imagesPreloaded=[],this.shown=!1,this.onResizeFrame=this.onResizeFrame.bind(this),this.onCloseClick=this.onCloseClick.bind(this),this.destroy=this.destroy.bind(this),this.teaserClick=this.teaserClick.bind(this)}function b(s,t,n){this.node=s,this.campaign=t,this.section=n,this.settings=n.data.config.settings&&n.data.config.settings.addons&&n.data.config.settings.addons.hideandseek&&n.data.config.settings.addons.hideandseek.settings?n.data.config.settings.addons.hideandseek.settings:{},this.campaign.utility.createCookie("force_show",JSON.stringify({campaign_id:this.campaign.campaign_id,section:n.index}),30,"/");var a=document.createElement("div");a.innerHTML=this.settings.content,s.appendChild(a),this.campaign.utility.getCookie("hideandseek",function(i){if(null!==i)try{i=JSON.parse(i)}catch(t){i={}}else i={};var t;if(i.started=i.started||!1,i.visits=i.visits||[],i.clicks=void 0!==i.clicks?parseInt(i.clicks,10):parseInt(this.settings.clicks,10),i.currentItem=void 0!==i.currentItem?parseInt(i.currentItem,10):0,i.triggerUrl=i.triggerUrl||"",i.started&&-1===i.visits.indexOf(window.top.location.href)&&window.top.location.href!=i.triggerUrl){if(i.clicks--,i.visits.push(window.top.location.href),(t=void 0!==this.settings.items[i.currentItem]?this.settings.items[i.currentItem]:null).url==window.top.location.href){i.currentItem++;var e=document.createElement("div");e.className="hideandseek__success",e.innerHTML=['<div class="hideandseek__success-icon">','<svg xmlns="http://www.w3.org/2000/svg" width="7.2rem" height="7.2rem">','<g fill="none" stroke="#86bf6f" stroke-width="2">','<circle cx="36" cy="36" r="35" style="stroke-dasharray: 24rem, 24rem; stroke-dashoffset: 48rem;"></circle>','<path d="M17.417,37.778l9.93,9.909l25.444-25.393" style="stroke-dasharray:5rem, 5rem; stroke-dashoffset: 0;"></path>',"</g>","</svg>","</div>"].join(""),s.parentNode.parentNode.parentNode.appendChild(e),setTimeout(function(){setTimeout(function(){e.className+=" hideandseek__success--hide",setTimeout(function(){e.parentNode.removeChild(e)},250)},1e3)},2200)}}else i.started||(i.started=!0,i.triggerUrl=window.top.location.href,this.campaign.utility.createCookie("force_show",JSON.stringify({campaign_id:this.campaign.campaign_id,section:n.index}),30,"/"));0<i.clicks&&i.currentItem!==this.settings.items.length?null!==(t=void 0!==this.settings.items[i.currentItem]?this.settings.items[i.currentItem]:null)&&(a.innerHTML=this.settings.content.replace("#hint#",t.hint).replace("#hint_image#",'<img src="'+t.hint_image+'" />').replace("#clicks#",i.clicks)):(this.campaign.utility.deleteCookie("hideandseek"),this.campaign.utility.deleteCookie("force_show"),this.campaign.destroy(),i.ended=!0,i.won=i.currentItem===this.settings.items.length,i.won?(this.campaign.storage.ended=1,this.campaign.storage.ended_on=(new Date).getTime(),this.campaign.saveStorage()):(i.started=!1,i.currentItem=0,i.visits=[],i.clicks=parseInt(this.settings.clicks,10),i.triggerUrl=""),i.currentItem===this.settings.items.length?(this.campaign.onNextSectionHandler=function(){this.campaign.destroy(),this.campaign.render(3)}.bind(this),this.campaign.render(2)):this.campaign.render(4)),this.campaign.utility.createCookie("hideandseek",JSON.stringify(i),30,"/")}.bind(this))}function _(t,i,e){this.node=t,this.campaign=i,this.section=e,this.settings=e.data.config.settings&&e.data.config.settings.addons&&e.data.config.settings.addons["iframe-element"]&&e.data.config.settings.addons["iframe-element"].settings?e.data.config.settings.addons["iframe-element"].settings:{};var s=document.createElement("div");s.className="iframe-element-addon iframe-element-addon--placeholder",this.container=s,this.settings.fixed_height&&""!==this.settings.fixed_height&&(s.style.height=this.settings.fixed_height+"px");var n="";switch(this.settings.width){case"fixed":this.settings.fixed_width&&""!==this.settings.fixed_width&&(n=this.settings.fixed_width+"px"),this.settings.alignment&&""!==this.settings.alignment&&(s.className+=" iframe-element-addon--alignment-"+this.settings.alignment);break;case"window":case"content":n="100%"}s.style.width=n,this.container=s;var a=document.createElement("div");a.className="iframe-element-addon-wrapper",s.appendChild(a),t.appendChild(s),window.addEventListener("message",this.receiveMessage.bind(this),!1),setTimeout(function(){this.iframe=document.createElement("iframe"),this.campaign.utility.devices.mobile&&(this.settings.show_scrollbars=1),-1!==this.settings.url.indexOf("/campaign/view")&&(this.settings.url+="/?iframe=dontbreakout"),this.iframe.src=r(this.settings.url),this.iframe.scrolling="0"==this.settings.show_scrollbars?"no":"auto","0"==this.settings.show_scrollbars?this.iframe.style.overflow="hidden":this.iframe.style.overflow="",this.iframe.frameBorder="0",this.iframe.className="iframe-element-addon-element",-1===this.settings.url.indexOf("/campaign/view/")&&(this.iframe.onload=function(){iframe.className+=" iframe-element-addon-element--ready"}),a.appendChild(this.iframe)}.bind(this),625)}function y(t,i,e){this.node=t,this.campaign=i,this.section=e,this.lastKnownHeight=300,this.firstResize=!0,this.currentHeight=300,this.runReadyAfterFirstResize=!1,this.iframe=null,this.resizing=!1,this.resizeAnimationFrameId=null,this.resizeTimeout=null,this.minHeight=300,this._onResize=this._onResize.bind(this),this._onResizeFrame=this._onResizeFrame.bind(this),this._onResizeEnd=this._onResizeEnd.bind(this),this.settings=e.data.config.settings&&e.data.config.settings.addons&&e.data.config.settings.addons["iframe-games"]&&e.data.config.settings.addons["iframe-games"].settings?e.data.config.settings.addons["iframe-games"].settings:{},void 0!==this.settings.min_height&&(this.minHeight=this.lastKnownHeight=this.currentHeight=parseInt(this.settings.min_height,10));var s=document.createElement("div");s.className="iframe-games-addon iframe-games-addon--placeholder",this.container=s,this.settings.fixed_height&&""!==this.settings.fixed_height&&1!=this.settings.responsive_height?s.style.height=this.settings.fixed_height+"px":1==this.settings.responsive_height&&(s.style.height=this.minHeight+"px");var n="";switch(this.settings.width){case"fixed":this.settings.fixed_width&&""!==this.settings.fixed_width&&(n=this.settings.fixed_width+"px"),this.settings.alignment&&""!==this.settings.alignment&&(s.className+=" iframe-games-addon--alignment-"+this.settings.alignment);break;case"window":case"content":n="100%"}s.style.width=n,this.container=s;var a=document.createElement("div");a.className="iframe-games-addon-wrapper",s.appendChild(a),t.appendChild(s),window.addEventListener("message",this.receiveMessage.bind(this),!1),setTimeout(function(){this.iframe=document.createElement("iframe"),this.campaign.utility.devices.mobile&&!this.campaign.popup.isTesting&&(this.settings.show_scrollbars=1),void 0!==this.settings.show_game_only&&1==this.settings.show_game_only&&(this.settings.game_url+="/onlyFlow:1"),this.settings.game_url+="/isFromPopup:1",null!==document.querySelector(".game-popup-preview")&&(this.settings.game_url+="/device:iphone/preview:true"),-1===this.settings.game_url.indexOf("iframe=dontbreakout")&&(this.settings.game_url+="/?iframe=dontbreakout"),void 0!==this.settings.no_mobile_layout&&1==this.settings.no_mobile_layout&&(this.settings.game_url+=(-1===this.settings.game_url.indexOf("?")?"/?":"&")+"no_mobile_layout=y"),this.settings.game_url=r(this.settings.game_url),this.iframe.src=this.settings.game_url,this.iframe.scrolling="0"==this.settings.show_scrollbars?"no":"auto","0"==this.settings.show_scrollbars?this.iframe.style.overflow="hidden":this.iframe.style.overflow="",this.iframe.frameBorder="0",this.iframe.className="iframe-games-addon-element",a.appendChild(this.iframe)}.bind(this),625)}function w(t,i,e){this.node=t,this.campaign=i,this.section=e,this.fields=[],this.settings=e.data.config.settings&&e.data.config.settings.addons&&e.data.config.settings.addons.registration&&e.data.config.settings.addons.registration.settings?e.data.config.settings.addons.registration.settings:{},this.paint();var s=document.createDocumentFragment();if(this.settings.fields&&0<this.settings.fields.length){this.settings.fields.forEach(function(t){s.appendChild(this.buildField(t))}.bind(this));var n=document.createElement("div");n.className="registration-form-addon";var a=document.createElement("div");a.className="registration-form";var o=document.createElement("form");o.className="content-type content-type-form",a.appendChild(o),n.appendChild(a),o.appendChild(s),this.settings.button&&1==this.settings.button.enabled&&o.appendChild(this.buildButton()),this.node.appendChild(n)}}function k(t,i,e,s){this.campaign=e,this.field=t,this.settings=s.data.config.settings&&s.data.config.settings.addons&&s.data.config.settings.addons.registration&&s.data.config.settings.addons.registration.settings?s.data.config.settings.addons.registration.settings:{}}function x(t,i,e,s){this.campaign=e,this.field=t,this.node=null,this.inputNode=null,this.settings=s.data.config.settings&&s.data.config.settings.addons&&s.data.config.settings.addons.registration&&s.data.config.settings.addons.registration.settings?s.data.config.settings.addons.registration.settings:{},this.onChange=this.onChange.bind(this),this.onFocus=this.onFocus.bind(this),this.onBlur=this.onBlur.bind(this)}function N(t,i,e,s){this.campaign=e,this.field=t,this.node=null,this.inputNode=null,this.settings=s.data.config.settings&&s.data.config.settings.addons&&s.data.config.settings.addons.registration&&s.data.config.settings.addons.registration.settings?s.data.config.settings.addons.registration.settings:{},this.onChange=this.onChange.bind(this),this.onFocus=this.onFocus.bind(this),this.onBlur=this.onBlur.bind(this)}function C(t,i,e,s){this.field=t,this.node=null,this.inputNode=null,this.campaign=e,this.onFocus=this.onFocus.bind(this),this.onBlur=this.onBlur.bind(this)}function T(t,i,e,s){this.field=t,this.node=null,this.inputNode=null,this.campaign=e}function I(t,i,e,s){this.field=t,this.node=null,this.selectNode=null,this.selectSelectedNode=null,this.selectFieldNode=null,this.campaign=e,this.onChange=this.onChange.bind(this),this.onSelectedClick=this.onSelectedClick.bind(this)}function F(t,i,e,s){this.field=t,this.node=null,this.campaign=e}function L(t,i,e){t.getAttribute("href");if(this.node=t,this.campaign=i,this.section=e,this.onClick=this.onClick.bind(this),this.campaign.popup.bind(t,"click",this.onClick),this.node.classList&&this.node.classList.contains("button-standard")){var s=this.section.frameWindow.getComputedStyle(this.node);this.padding=this.node.getAttribute("data-original-padding"),this.backgroundColor=this.node.getAttribute("data-original-backgroundcolor"),this.color=this.node.getAttribute("data-original-color"),this.borderColor=this.node.getAttribute("data-original-bordercolor"),this.borderWidth=this.node.getAttribute("data-original-borderwidth"),this.backgroundColor&&""!==this.backgroundColor||(this.backgroundColor=s.backgroundColor),this.color&&""!==this.color||(this.color=s.color),this.borderColor&&""!==this.borderColor||(this.borderColor=s.borderColor),this.padding&&""!==this.padding||(this.padding=s.padding),this.borderWidth&&""!==this.borderWidth||(this.borderWidth=s.borderWidth),this.hoverBackgroundColor=this.node.getAttribute("data-hoverbackgroundcolor"),this.hoverColor=this.node.getAttribute("data-hovercolor"),this.hoverBorderColor=this.node.getAttribute("data-hoverbordercolor"),this.paintHover=this.paintHover.bind(this),this.paintOriginal=this.paintOriginal.bind(this),this.campaign.popup.bind(t,"mouseover",this.paintHover),this.campaign.popup.bind(t,"mouseleave",this.paintOriginal),s=null}}function z(t,i,e){this.node=t,this.campaign=i,this.section=e,this.settings=e.data.config.settings&&e.data.config.settings.addons&&e.data.config.settings.addons.raptor&&e.data.config.settings.addons.raptor.settings?e.data.config.settings.addons.raptor.settings:{},this.node.classList.contains("raptor-addon")||this.node.classList.add("raptor-addon");var s=document.createDocumentFragment();this.throbber=document.createElement("div"),this.throbber.className="throbber",s.appendChild(this.throbber),this.items_to_show=void 0!==this.settings.items_to_show?parseInt(this.settings.items_to_show,10):4,this.load(),this.node.appendChild(s)}function O(){this.customers=[],this.campaigns=[],this.utility=null,this.isShowingCampaigns=[],this.resizing=!1,this.resizeAnimationFrameId=null,this.resizeTimeout=null,this.isTesting=!1,this.logs=[]}o&&o<=8||void 0===d.games_popup_instance&&(h.prototype.onResizeFrame=function(){if(this.utility||(this.utility=d.popup_utility),0<this.sections.length)for(var t in this.sections)this.sections.hasOwnProperty(t)&&this.sections[t].onResizeFrame()},h.prototype.onInputFocus=function(){if(this.utility||(this.utility=d.popup_utility),0<this.sections.length)for(var t in this.sections)this.sections.hasOwnProperty(t)&&this.sections[t].onInputFocus()},h.prototype.onInputBlur=function(){if(this.utility||(this.utility=d.popup_utility),0<this.sections.length)for(var t in this.sections)this.sections.hasOwnProperty(t)&&this.sections[t].onInputBlur()},h.prototype.saveStorage=function(){this.popup.isTesting?this.popup.info(this.campaign_id+")","no storage saved due to testing:"):this.utility.getCookie("campaigns",function(i){if(null!==i)try{i=JSON.parse(i)}catch(t){i={}}else i={};i[this.campaign_id]=this.storage,this.popup.info(this.campaign_id+")","saved storage:",this.storage),this.utility.createCookie("campaigns",JSON.stringify(i),30,"/")}.bind(this))},h.prototype.getStorage=function(t){null===this.storage?this.utility.getCookie("campaigns",function(i){if(null!==i)try{i=JSON.parse(i)}catch(t){i={}}else i={};this.storage=i[this.campaign_id]||{},this.popup.info(this.campaign_id+")","got storage:",this.storage),t(this.storage)}.bind(this)):(this.popup.info(this.campaign_id+")","got storage:",this.storage),t(this.storage))},h.prototype.recursivelyRemoveAbsolute=function(t){var i=(typeof t).toLowerCase();if("string"===i)t=t.replace(/https?:\/\/[a-z0-9_\-\.]*(\/files\/[a-z0-9_\-\.\/]*.(jpeg|png|gif|jpg))/gim,"$1");else if("object"===i&&null!==t)if(void 0!==t.length)for(var e=0,s=t.length;e<s;e++)t[e]=this.recursivelyRemoveAbsolute(t[e]);else for(var n in t)t.hasOwnProperty(n)&&(t[n]=this.recursivelyRemoveAbsolute(t[n]));return t},h.prototype.getLongData=function(r){void 0===this.data.game||this.popup.isTesting?(this.utility||(this.utility=d.popup_utility),this.utility.fetchJson(c+"/cache/campaign/popup/campaign_"+this.campaign_id+".json?r="+Math.floor(Math.floor((new Date).getTime()/1e3)/86400),function(t){this.popup.isTesting&&(t=this.recursivelyRemoveAbsolute(t));var i=this.data;if(this.data=t,!this.popup.isTesting)for(var e in i)i.hasOwnProperty(e)&&(this.data[e]=i[e]);if(i=null,this.data&&this.data.sections&&0<this.data.sections.length)for(var s in this.data.sections)if(this.data.sections.hasOwnProperty(s)){var n=null;if(0<this.sections.length)for(var a=0,o=this.sections.length;a<o;a++)this.sections[a].id==this.data.sections[s].id&&(n=this.sections[a]);null!==n&&(n.data=this.data.sections[s])}this.popup.info(this.campaign_id+")","got long data:",this.data),r(t)}.bind(this))):r(this.data)},h.prototype.getSectionById=function(t){if(t=parseInt(t,10),this.data.sections&&0<this.data.sections.length)for(var i in this.data.sections)if(this.data.sections.hasOwnProperty(i)&&parseInt(this.data.sections[i].id,10)===t)return this.data.sections[i];return null},h.prototype.getSectionByIndex=function(t){return t=parseInt(t,10),this.data.sections&&0<this.data.sections.length&&this.data.sections[t]?this.data.sections[t]:null},h.prototype.iterateSectionConditions=function(t){for(var i=t;this.getSectionByIndex(i)&&(this.getSectionByIndex(i).config.hidden||!this.utility.checkConditions(this.campaign_id+"_"+i,this.storage,{active:!0,devices:{desktop:this.getSectionByIndex(i).config.devices.desktop,tablet:this.getSectionByIndex(i).config.devices.desktop,mobile:this.getSectionByIndex(i).config.devices.mobile}}));)i++;return this.getSectionByIndex(i)?i:-1},h.prototype.preloadSection=function(t){var i=this.getSectionByIndex(t);if(i&&i.content&&i.content.length){var e=null;if(0<this.sections.length)for(var s=0,n=this.sections.length;s<n;s++)this.sections[s].id==i.id&&(e=this.sections[s]);null===e&&(e=new p(i.id,i,this,t),this.sections.push(e)),e.preloadFrame(function(){this.preload()}.bind(e))}},h.prototype.render=function(t){this.utility||(this.utility=d.popup_utility),t=this.iterateSectionConditions(t);var i=this.getSectionByIndex(t);if(this.sectionIndex=t,i&&i.content&&i.content.length){var e=null;if(0<this.sections.length)for(var s=0,n=this.sections.length;s<n;s++)this.sections[s].id==i.id&&(e=this.sections[s]);null===e&&(e=new p(i.id,i,this,t),this.sections.push(e)),e.show()}else for(var a=0,o=this.sections.length;a<o;a++)this.sections[a].destroy()},h.prototype.destroy=function(){if(0<this.sections.length)for(var t in this.sections)this.sections.hasOwnProperty(t)&&this.sections[t].destroy()},h.prototype.validate=function(){var i=!0;if(0<this.sections.length)for(var t in this.sections)this.sections.hasOwnProperty(t)&&this.sections[t].shown&&this.sections[t].callDirectiveMethod("validate",this.sections[t].container,function(t){t||(i=!1)});return i},h.prototype.nextSection=function(){this.disableNextSection||(this.disableNextSection=!0,this.validate()?null!==this.onNextSectionHandler?this.onNextSectionHandler():(this.destroy(),this.render(this.sectionIndex+1)):this.disableNextSection=!1)},p.prototype.onInputFocus=function(){this.shown&&(this.utility.devices.mobile||this.utility.devices.tablet)&&this.destroy()},p.prototype.onInputBlur=function(){this.utility.devices.mobile},p.prototype.onResizeFrame=function(){if(this.shown&&this.data&&this.data.content&&0<this.data.content.length){this.utility.devices.mobile&&this.data.config.settings&&this.data.config.settings.mobile&&this.data.config.settings.mobile.background&&0==this.data.config.settings.mobile.background.overwrite&&(this.data.config.settings.background_color=this.data.config.settings.mobile.background_color,this.data.config.settings.background_image=this.data.config.settings.mobile.background_image,this.data.config.settings.background_position=this.data.config.settings.mobile.background_position,this.data.config.settings.background_transparency=this.data.config.settings.mobile.background_transparency,this.data.config.settings.background_type=this.data.config.settings.mobile.background_type),this.utility.devices.mobile&&this.data.config.settings&&void 0!==this.data.config.settings.overwrite_mobile_close&&"0"==this.data.config.settings.overwrite_mobile_close&&this.data.config.settings.mobile&&this.data.config.settings.mobile.close&&this.data.config.settings.close&&this.data.config.settings.close.enabled&&(this.data.config.settings.close=this.data.config.settings.mobile.close,this.data.config.settings.close.enabled=1),this.utility.devices.mobile&&this.data.config.settings&&this.data.config.settings.mobile&&0===parseInt(this.data.config.settings.overwrite_mobile_size,10)&&(this.data.config.settings.height=this.data.config.settings.mobile.height,this.data.config.settings.width=this.data.config.settings.mobile.width),this.utility.devices.mobile&&this.data.config.settings&&this.data.config.settings.mobile&&0===parseInt(this.data.config.settings.overwrite_mobile_position,10)&&(this.data.config.settings.position=this.data.config.settings.mobile.position,this.data.config.settings.padding_top=this.data.config.settings.mobile.padding_top,this.data.config.settings.padding_right=this.data.config.settings.mobile.padding_right,this.data.config.settings.padding_bottom=this.data.config.settings.mobile.padding_bottom,this.data.config.settings.padding_left=this.data.config.settings.mobile.padding_left,this.data.config.settings.margin_top=this.data.config.settings.mobile.margin_top,this.data.config.settings.margin_right=this.data.config.settings.mobile.margin_right,this.data.config.settings.margin_bottom=this.data.config.settings.mobile.margin_bottom,this.data.config.settings.margin_left=this.data.config.settings.mobile.margin_left),this.utility.devices.mobile&&0===this.index&&void 0===this.data.config.settings.overwrite_mobile_position&&(this.data.config.settings.position="bottom_center",this.data.config.settings.margin_top=this.data.config.settings.margin_right=this.data.config.settings.margin_left=this.data.config.settings.margin_bottom="",this.data.config.settings.width="100%",this.data.config.settings.transition.enter=this.data.config.settings.transition.leave="slide",void 0===this.data.config.settings.overwrite_mobile_close&&(this.data.config.settings.close.enabled=1,this.data.config.settings.close.offset={x:0,y:-40}),this.data.config.settings.overlay=0),this.utility.devices.mobile&&1===this.index&&void 0===this.data.config.settings.overwrite_mobile_position&&(this.data.config.settings.position="top_center",this.data.config.settings.margin_bottom=this.data.config.settings.margin_right=this.data.config.settings.margin_left="",this.data.config.settings.width="100%",this.data.config.settings.transition.enter="slide-reversed",this.data.config.settings.transition.leave="fade",void 0===this.data.config.settings.overwrite_mobile_close&&(this.data.config.settings.close.enabled=1,this.data.config.settings.close.offset={x:0,y:0}),this.data.config.settings.padding_top=50,this.data.config.settings.overlay=1),this.utility.devices.mobile&&1===this.index&&(this.data.config.settings.position="top_center",this.data.config.settings.margin_top=this.campaign.popup.isTesting?0:this.scrollY),this.utility.devices.mobile&&2===this.index&&void 0===this.data.config.settings.overwrite_mobile_position&&(this.data.config.settings.position="bottom_center",this.data.config.settings.margin_bottom=this.data.config.settings.margin_right=this.data.config.settings.margin_left=this.data.config.settings.margin_top="",this.data.config.settings.width="100%",this.data.config.settings.transition.enter=this.data.config.settings.transition.leave="slide",void 0===this.data.config.settings.overwrite_mobile_close&&(this.data.config.settings.close.enabled=1,this.data.config.settings.close.offset={x:0,y:-40}),this.data.config.settings.overlay=0),this.utility.devices.mobile&&void 0===this.data.config.settings.overwrite_mobile_close&&(this.data.config.settings.close.offset={x:0,y:0}),1!=this.data.config.settings.overlay&&this.frameDocument.body.classList.remove("overlay");var t=parseInt(this.data.config.settings.margin_right,10),i=parseInt(this.data.config.settings.margin_left,10);if(isNaN(t)&&(t=0),isNaN(i)&&(i=0),this.data.config.settings.close&&1==this.data.config.settings.close.enabled){var e=parseInt(this.data.config.settings.close.offset.x,10);switch(void 0===this.data.config.settings.close.position&&(this.data.config.settings.close.position="top_right"),this.data.config.settings.close.position){case"top_left":!isNaN(e)&&e<0&&(i+=Math.abs(e));break;case"top_right":!isNaN(e)&&0<e&&(t+=e)}}this.container.style.cssText=this.getStyle({width:this.data.config.settings.width,height:this.data.config.settings.height,text_color:"1"==this.data.config.settings.default_text_color?"":this.data.config.settings.text_color,margin_top:this.data.config.settings.margin_top,margin_right:t,margin_bottom:this.data.config.settings.margin_bottom,margin_left:i,close_button_offset_x:this.data.config.settings.close&&1==this.data.config.settings.close.enabled?parseInt(this.data.config.settings.close.offset.x,10):0,close_button_offset_y:this.data.config.settings.close&&1==this.data.config.settings.close.enabled?parseInt(this.data.config.settings.close.offset.y,10):0}),this.callDirectiveMethod("onResizeFrame",this.container)}if(this.frameContainer&&0<this.frameContainer.childNodes.length){var s=1==this.data.config.settings.overlay,n={};this.frame.style.marginLeft=this.frame.style.marginTop="",n.left="0px",n.top="0px",n.right="auto",n.bottom="auto",n.position=void 0!==window.game_popup_container&&this.utility.devices.mobile?"absolute":"fixed",this.setTransform(this.frame.style,"none");var a=this.getSize(),o=this.getWindowWidth(),r=this.getWindowHeight();if(n.width=a.width>=o?"100%":a.width+"px",n.height=a.height>=r&&!this.utility.devices.mobile?"100%":a.height+"px",!s&&("100%"!=n.width||"100%"!=n.height))switch(this.data.config.settings.position){case"top_left":break;case"top_center":n.left="50%",n.marginLeft="-"+a.width/2+"px";break;case"top_right":n.left="auto",n.right="0";break;case"center_left":n.top="50%",n.marginTop="-"+a.height/2+"px";break;case"center_center":n.top="50%",n.left="50%",n.marginLeft="-"+a.width/2+"px",n.marginTop="-"+a.height/2+"px";break;case"center_right":n.top="50%",n.right="0",n.left="auto",n.marginTop="-"+a.height/2+"px";break;case"bottom_left":n.top="auto",n.bottom="0";break;case"bottom_center":n.top="auto",n.bottom="0",n.left="50%",n.marginLeft="-"+a.width/2+"px";break;case"bottom_right":n.top="auto",n.bottom="0",n.right="0",n.left="auto"}this.utility.devices.mobile&&1===this.index&&(n.position="absolute",n.height=a.height+"px",n.minHeight=document.documentElement.offsetHeight+"px"),this.setStyle(n,this.frame),a=o=r=n=null,"none"==this.frame.style.display&&(this.frame.style.display="block")}else null!==this.frame&&(this.frame.style.display="none")},p.prototype.preload=function(t){t=t||null;var i=[],e=[],s=0;this.getImagesFromObject(this.data,i),this.getFontsFromObject(this.data,e),this.getFontsFromObject(this.campaign.data.config,e),s+=i.length+e.length;var n=!1,a=function(){0!==--s||null===t||n||(n=!0,t())}.bind(this);if(0<i.length){var o;for(var r in i)i.hasOwnProperty(r)&&((o=new Image).onload=o.onabort=o.onerror=a,o.src=i[r]);o=null}if(0<e.length)for(var d in e)if(e.hasOwnProperty(d)){if(void 0!==this.campaign.data.config.fonts&&-1!==this.campaign.data.config.fonts.indexOf(e[d])||0===e[d].indexOf("Material Design Icons")){a();continue}var c=document.createElement("link"),h=e[d].replace(/"/gi,"").replace(/ /gi,"+").replace(/\\/gi,"");c.rel="stylesheet",c.type="text/css",c.onload=c.onabort=c.onerror=a,c.href="https://fonts.googleapis.com/css?family="+h+":300,300i,400,400i,500,500i,600,600i,700,700i",c.setAttribute("data-font",h),this.frameDocument.head.appendChild(c),c=null}0!==s||null===t||n||t()},p.prototype.teaserClick=function(){this.campaign.nextSection()},p.prototype.actionHandler=function(){null!==this.actionTimer&&(clearTimeout(this.actionTimer),this.actionTimer=null),this.actionTimer=setTimeout(function(){switch(this.data.config.settings.action.type){case"next_page":this.campaign.nextSection();break;case"redirect":void 0!==this.data.config.settings.action.redirect_url&&""!=this.data.config.settings.action.redirect_url&&(window.top.location.href=r(this.data.config.settings.action.redirect_url))}this.actionTimer=null}.bind(this),1e3*parseInt(this.data.config.settings.action.delay,10))},p.prototype.show=function(){if(!this.shown||this.campaign.popup.isTesting){if(this.shown=!0,void 0!==this.data.config&&void 0!==this.data.config.settings&&void 0!==this.data.config.settings.action&&void 0!==this.data.config.settings.action.type&&""!=this.data.config.settings.action.type&&(void 0===this.data.config.settings.action.delay||"0"==this.data.config.settings.action.delay))return void this.actionHandler();this.scrollY=n(),this.preloadFrame(function(){this.preload(function(){if(this.data&&this.data.content&&0<this.data.content.length){this.campaign.popup.info(this.campaign_id+")","'"+this.id+"'",this.data),this.campaign.popup.info(this.campaign_id+")","rendering '"+this.id+"' "+((new Date).getTime()-f)+"ms after initial load"),this.utility.devices.mobile&&this.data.config.settings&&this.data.config.settings.mobile&&this.data.config.settings.mobile.background&&0==this.data.config.settings.mobile.background.overwrite&&(this.data.config.settings.background_color=this.data.config.settings.mobile.background_color,this.data.config.settings.background_image=this.data.config.settings.mobile.background_image,this.data.config.settings.background_position=this.data.config.settings.mobile.background_position,this.data.config.settings.background_transparency=this.data.config.settings.mobile.background_transparency,this.data.config.settings.background_type=this.data.config.settings.mobile.background_type),this.utility.devices.mobile&&this.data.config.settings&&void 0!==this.data.config.settings.overwrite_mobile_close&&"0"==this.data.config.settings.overwrite_mobile_close&&this.data.config.settings.mobile&&this.data.config.settings.mobile.close&&this.data.config.settings.close&&this.data.config.settings.close.enabled&&(this.data.config.settings.close=this.data.config.settings.mobile.close,this.data.config.settings.close.enabled=1),this.utility.devices.mobile&&this.data.config.settings&&this.data.config.settings.mobile&&0===parseInt(this.data.config.settings.overwrite_mobile_size,10)&&(this.data.config.settings.height=this.data.config.settings.mobile.height,this.data.config.settings.width=this.data.config.settings.mobile.width),this.utility.devices.mobile&&this.data.config.settings&&this.data.config.settings.mobile&&0===parseInt(this.data.config.settings.overwrite_mobile_position,10)&&(this.data.config.settings.position=this.data.config.settings.mobile.position,this.data.config.settings.padding_top=this.data.config.settings.mobile.padding_top,this.data.config.settings.padding_right=this.data.config.settings.mobile.padding_right,this.data.config.settings.padding_bottom=this.data.config.settings.mobile.padding_bottom,this.data.config.settings.padding_left=this.data.config.settings.mobile.padding_left,this.data.config.settings.margin_top=this.data.config.settings.mobile.margin_top,this.data.config.settings.margin_right=this.data.config.settings.mobile.margin_right,this.data.config.settings.margin_bottom=this.data.config.settings.mobile.margin_bottom,this.data.config.settings.margin_left=this.data.config.settings.mobile.margin_left),this.utility.devices.mobile&&0===this.index&&void 0===this.data.config.settings.overwrite_mobile_position&&(this.data.config.settings.position="bottom_center",this.data.config.settings.margin_top=this.data.config.settings.margin_right=this.data.config.settings.margin_left=this.data.config.settings.margin_bottom="",this.data.config.settings.width="100%",this.data.config.settings.transition.enter=this.data.config.settings.transition.leave="slide",void 0===this.data.config.settings.overwrite_mobile_close&&(this.data.config.settings.close.enabled=1,this.data.config.settings.close.offset={x:0,y:-40}),this.data.config.settings.overlay=0),this.utility.devices.mobile&&1===this.index&&void 0===this.data.config.settings.overwrite_mobile_position&&(this.data.config.settings.position="top_center",this.data.config.settings.margin_bottom=this.data.config.settings.margin_right=this.data.config.settings.margin_left=this.data.config.settings.margin_top="",this.data.config.settings.width="100%",this.data.config.settings.transition.enter="slide-reversed",this.data.config.settings.transition.leave="fade",void 0===this.data.config.settings.overwrite_mobile_close&&(this.data.config.settings.close.enabled=1,this.data.config.settings.close.offset={x:0,y:0}),this.data.config.settings.padding_top=50,this.data.config.settings.margin_top=this.campaign.popup.isTesting?0:this.scrollY,this.data.config.settings.overlay=1),this.utility.devices.mobile&&1===this.index&&(this.data.config.settings.position="top_center",this.data.config.settings.margin_top=this.campaign.popup.isTesting?0:this.scrollY),this.utility.devices.mobile&&2===this.index&&void 0===this.data.config.settings.overwrite_mobile_position&&(this.data.config.settings.position="bottom_center",this.data.config.settings.margin_bottom=this.data.config.settings.margin_right=this.data.config.settings.margin_left=this.data.config.settings.margin_top="",this.data.config.settings.width="100%",this.data.config.settings.transition.enter=this.data.config.settings.transition.leave="slide",void 0===this.data.config.settings.overwrite_mobile_close&&(this.data.config.settings.close.enabled=1,this.data.config.settings.close.offset={x:0,y:-40}),this.data.config.settings.overlay=0),this.utility.devices.mobile&&void 0===this.data.config.settings.overwrite_mobile_close&&(this.data.config.settings.close.offset={x:0,y:0}),1!=this.data.config.settings.overlay&&this.frameDocument.body.classList.remove("overlay");var t=parseInt(this.data.config.settings.margin_right,10),i=parseInt(this.data.config.settings.margin_left,10);if(isNaN(t)&&(t=0),isNaN(i)&&(i=0),this.data.config.settings.close&&1==this.data.config.settings.close.enabled){var e=parseInt(this.data.config.settings.close.offset.x,10);switch(void 0===this.data.config.settings.close.position&&(this.data.config.settings.close.position="top_right"),this.data.config.settings.close.position){case"top_left":!isNaN(e)&&e<0&&(i+=Math.abs(e));break;case"top_right":!isNaN(e)&&0<e&&(t+=e)}}var s={width:this.data.config.settings.width,height:this.data.config.settings.height,text_color:"1"==this.data.config.settings.default_text_color?"":this.data.config.settings.text_color,margin_top:this.data.config.settings.margin_top,margin_right:t,margin_bottom:this.data.config.settings.margin_bottom,margin_left:i,close_button_offset_x:this.data.config.settings.close&&1==this.data.config.settings.close.enabled?parseInt(this.data.config.settings.close.offset.x,10):0,close_button_offset_y:this.data.config.settings.close&&1==this.data.config.settings.close.enabled?parseInt(this.data.config.settings.close.offset.y,10):0},n=document.createElement("div");n.__section=this.data,n.className=this.getContainerClassName(),n.style.cssText=this.getStyle(s),this.isTeaser&&this.campaign.popup.bindOnce(n,"click",this.teaserClick),this.container=n;var a=document.createElement("div");a.className=u+"wrapper",this.paint(a),this.data.config.settings.position&&""!==this.data.config.settings.position&&(a.className+=" "+u+"wrapper--position-"+this.data.config.settings.position.replace("_","-"));var o=document.createElement("div");o.className=u+"animation",this.data.config.settings.transition&&this.data.config.settings.transition.enter&&""!==this.data.config.settings.transition.enter?o.className+=" "+u+"animation--transition-"+this.data.config.settings.transition.enter+"-enter":o.className+=" "+u+"animation--transition-none-enter",o.style.cssText=this.getStyle({background_color:"0"==this.data.config.settings.background_transparent?this.data.config.settings.background_color:"",padding_top:this.data.config.settings.padding_top,padding_right:this.data.config.settings.padding_right,padding_bottom:this.data.config.settings.padding_bottom,padding_left:this.data.config.settings.padding_left});var r=document.createElement("div");r.className="content";var d=document.createElement("div");if(d.className="content-type content-type-text",r.appendChild(d),"0"==this.data.config.settings.background_transparent){var c=document.createElement("div");c.className=u+"background",c.style.cssText=this.getStyle({background_type:this.data.config.settings.background_type,background_image:this.data.config.settings.background_image,background_position:this.data.config.settings.background_position,background_transparency:this.data.config.settings.background_transparency}),o.appendChild(c)}if(this.data.config.settings.close&&1===parseInt(this.data.config.settings.close.enabled,10)){var h=document.createElement("div");switch(h.className=u+"close",this.data.config.settings.close.custom&&1===parseInt(this.data.config.settings.close.custom,10)?(h.className+=" "+u+"close--theme-custom",this.data.config.settings.close.custom_image&&""!==this.data.config.settings.close.custom_image&&(h.style.backgroundImage="url("+this.data.config.settings.close.custom_image+")")):(h.className+=" "+u+"close--theme-styled",this.data.config.settings.close.icon_color&&""!==this.data.config.settings.close.icon_color&&(h.style.color=this.data.config.settings.close.icon_color),this.data.config.settings.close.border_radius&&""!==this.data.config.settings.close.border_radius&&(h.style.borderRadius=this.data.config.settings.close.border_radius+"%"),this.data.config.settings.close.background_color&&""!==this.data.config.settings.close.background_color&&(h.style.backgroundColor=this.data.config.settings.close.background_color),h.innerHTML='<i class="mdi mdi-close"></i>'),this.data.config.settings.close.shadow&&1===parseInt(this.data.config.settings.close.shadow,10)&&(h.className+=" "+u+"close--shadow"),this.data.config.settings.close.position){case"top_left":h.style.left=h.style.top="0px",h.style.right="auto",this.data.config.settings.close.offset&&this.data.config.settings.close.offset.x&&""!==this.data.config.settings.close.offset.x&&(h.style.marginLeft=parseInt(this.data.config.settings.close.offset.x,10)+"px"),this.data.config.settings.close.offset&&this.data.config.settings.close.offset.y&&""!==this.data.config.settings.close.offset.y&&(h.style.marginTop=this.data.config.settings.close.offset.y+"px");break;case"top_right":h.style.right=h.style.top="0px",h.style.left="auto",this.data.config.settings.close.offset&&this.data.config.settings.close.offset.x&&""!==this.data.config.settings.close.offset.x&&(h.style.marginRight=-1*parseInt(this.data.config.settings.close.offset.x,10)+"px"),this.data.config.settings.close.offset&&this.data.config.settings.close.offset.y&&""!==this.data.config.settings.close.offset.y&&(h.style.marginTop=this.data.config.settings.close.offset.y+"px")}this.campaign.popup.bindOnce(h,"click",this.onCloseClick),o.appendChild(h)}o.appendChild(r);var g=document.createDocumentFragment();for(var l in this.data.content)this.data.content.hasOwnProperty(l)&&g.appendChild(this.cookHTML(this.data.content[l].content.replace(/<div style\=\"position\: absolute\; bottom\: 0px\; left\: 0px\; z\-index\: 9999\;\"><br><\/div>/gi,"")));o.querySelector(".content-type-text").appendChild(g),n.appendChild(o),a.appendChild(n);var p=(new Date).getTime();this.preloadNode(a,function(t,i){this.campaign.popup.info(this.campaign_id+")","preload took"+((new Date).getTime()-p)+"ms"),a.style.display="none",a.offsetWidth,this.frameContainer.appendChild(a),this.processNode(a),this.processNode(a),a.style.display="block",a.offsetWidth,this.onResizeFrame(),this.campaign.popup.bindOnce(o,v(),this.enterTransitionEnd.bind(this)),setTimeout(function(){this.onResizeFrame(),1==this.data.config.settings.overlay&&this.frameDocument.body.classList.add("overlay"),this.campaign.popup.info(this.campaign_id+")","done rendering '"+this.id+"' "+((new Date).getTime()-f)+"ms after initial load"),this.data.config.settings.transition&&this.data.config.settings.transition.enter&&""!==this.data.config.settings.transition.enter?o.className+=" "+u+"animation--transition-"+this.data.config.settings.transition.enter+"-enter-active":o.className+=" "+u+"animation--transition-none-enter-active",void 0!==this.data.config&&void 0!==this.data.config.settings&&void 0!==this.data.config.settings.action&&void 0!==this.data.config.settings.action.type&&""!=this.data.config.settings.action.type&&void 0!==this.data.config.settings.action.delay&&"0"!=this.data.config.settings.action.delay&&this.actionHandler(),this.campaign.popup.isTesting||void 0===this.campaign.data||void 0===this.campaign.data.config||void 0===this.campaign.data.config.ga||void 0===this.campaign.data.config.ga.ua||""==this.campaign.data.config.ga.ua||(this.frame.contentWindow.window.ga("create",this.campaign.data.config.ga.ua,"auto"),this.campaign.firedGaPageview||(this.campaign.firedGaPageview=!0,this.frame.contentWindow.window.ga("create",this.campaign.data.config.ga.ua,"auto"),this.frame.contentWindow.window.ga("send","pageview")),this.firedGaEvent||void 0===this.campaign.data.config.ga.sections||void 0===this.campaign.data.config.ga.sections[parseInt(this.data.id,10)]||void 0===this.campaign.data.config.ga.sections[parseInt(this.data.id,10)].ga_event_enable||1!=this.campaign.data.config.ga.sections[parseInt(this.data.id,10)].ga_event_enable||(this.firedGaEvent=!0,this.frame.contentWindow.window.ga("send",{hitType:"event",eventCategory:this.campaign.data.config.ga.sections[parseInt(this.data.id,10)].ga_event_category,eventAction:this.campaign.data.config.ga.sections[parseInt(this.data.id,10)].ga_event_action,eventLabel:this.campaign.data.config.ga.sections[parseInt(this.data.id,10)].ga_event_label,eventValue:parseInt(this.campaign.data.config.ga.sections[parseInt(this.data.id,10)].ga_event_value)||void 0}))),setTimeout(function(){this.onResizeFrame()}.bind(this),1),setTimeout(function(){this.onResizeFrame()}.bind(this),275)}.bind(this),0<i.length?500:1)}.bind(this)),!this.campaign.getSectionByIndex(this.index+1)&&this.campaign.formularDidSubmit?(this.campaign.storage.ended=1,this.campaign.storage.ended_on=(new Date).getTime(),this.campaign.saveStorage()):this.campaign.preloadSection(this.index+1)}}.bind(this))}.bind(this))}},p.prototype.preloadFrame=function(t){if(this.campaign.popup.isTesting&&this.frame&&this.frame.parentNode&&this.frame.parentNode.removeChild(this.frame),!this.campaign.popup.isTesting&&this.frame&&this.frame.parentNode)this.frameLoading?this.frameLoadingCallback.push(t):t();else{this.imagesPreloaded=[],this.frameLoading=!0,this.frameLoadingCallback.push(t);var i=2,e=function(){if(0===--i&&0<this.frameLoadingCallback.length){for(var t in this.frameLoadingCallback)this.frameLoadingCallback.hasOwnProperty(t)&&this.frameLoadingCallback[t]();this.frameLoadingCallback=[]}0===i&&(this.frameLoading=!1)}.bind(this);this.frame=document.createElement("iframe"),this.frame.src="about:blank",this.frame.setAttribute("scrolling","no"),this.frame.id="leadfamly-popup-frame--"+this.campaign.campaign_id+"-"+this.id,this.frame.style.cssText=["border:0;","display:block;","width:0;","height:0;","position: "+(void 0!==window.game_popup_container&&this.utility.devices.mobile?"absolute":"fixed")+";","left:0;","top:-1px;","overflow: hidden;","background-color: transparent;","z-index: 9999999;"].join(""),void 0!==d.game_popup_container?d.game_popup_container.appendChild(this.frame):document.body.appendChild(this.frame),this.frameWindow=this.frame.contentWindow,this.frameDocument=this.frame.contentDocument||this.frame.contentWindow.document,this.frameDocument.open();var s="";this.campaign.popup.isTesting||void 0===this.campaign.data||void 0===this.campaign.data.config||void 0===this.campaign.data.config.ga||void 0===this.campaign.data.config.ga.ua||""==this.campaign.data.config.ga.ua||(s+='<script type="text/javascript">window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;<\/script><script async src="https://www.google-analytics.com/analytics.js"><\/script>'),this.frameDocument.write(["<!DOCTYPE html>","<html>","<head>"+s+"</head>",'<body class="'+this.getBodyClass()+'"></body>',"</html>"].join("")),this.frameDocument.close();var n=document.createElement("div");n.className="popup page",this.frameDocument.body.appendChild(n),this.frameContainer=n;var a=document.createElement("link");if(a.rel="stylesheet",a.type="text/css",a.href=c+"/campaign/sdk/games.popup.min.css"+(-1!==c.indexOf("dev03.accedo.dk")?"?="+(new Date).getTime():""),a.onload=a.onabort=a.onerror=e,this.frameDocument.head.appendChild(a),void 0!==this.campaign.data&&void 0!==this.campaign.data.config&&void 0!==this.campaign.data.config.css&&""!==this.campaign.data.config.css){var o=document.createElement("style");o.type="text/css",o.styleSheet?o.styleSheet.cssText=this.campaign.data.config.css:o.appendChild(document.createTextNode(this.campaign.data.config.css)),this.frameDocument.head.appendChild(o)}try{"complete"===this.frameDocument.readyState||"interactive"===this.frameDocument.readyState?e():this.frameDocument.addEventListener("DOMContentLoaded",function(){e()})}catch(t){this.error(t)}}},p.prototype.getStyle=function(t){var i={},e=0,s=0,n=0,a=0;if(t.padding_top&&""!==t.padding_top&&(i.paddingTop=t.padding_top+"px",s+=parseInt(t.padding_top,10)),t.padding_right&&""!==t.padding_right&&(i.paddingRight=t.padding_right+"px",e+=parseInt(t.padding_right,10)),t.padding_bottom&&""!==t.padding_bottom&&(i.paddingBottom=t.padding_bottom+"px",s+=parseInt(t.padding_bottom,10)),t.padding_left&&""!==t.padding_left&&(i.paddingLeft=t.padding_left+"px",e+=parseInt(t.padding_left,10)),t.margin_top&&""!==t.margin_top&&(i.marginTop=t.margin_top+"px",a+=parseInt(t.margin_top,10)),t.margin_right&&""!==t.margin_right&&(i.marginRight=t.margin_right+"px",n+=parseInt(t.margin_right,10)),t.margin_bottom&&""!==t.margin_bottom&&(i.marginBottom=t.margin_bottom+"px",a+=parseInt(t.margin_bottom,10)),t.margin_left&&""!==t.margin_left&&(i.marginLeft=t.margin_left+"px",n+=parseInt(t.margin_left,10)),t.height){var o=0;t.close_button_offset_y&&!isNaN(t.close_button_offset_y)&&0<t.close_button_offset_y&&(o=t.close_button_offset_y),i.height=parseInt(t.height,10)-s+"px",i.maxHeight=this.getWindowHeight()-a-o+"px"}if(t.width){var r=0;t.close_button_offset_x&&!isNaN(t.close_button_offset_x)&&0<t.close_button_offset_x&&(r=t.close_button_offset_x),-1!==(t.width+"").indexOf("100%")?i.width=this.getWindowWidth()-n-r+"px":(i.width=parseInt(t.width,10)-e+"px",i.maxWidth=this.getWindowWidth()-n-r+"px")}if(t.background_color&&""!==t.background_color&&(i.backgroundColor=l(t.background_color)),t.text_color&&""!==t.text_color&&(i.color=l(t.text_color)),t.background_image&&""!==t.background_image&&(i.backgroundImage="url("+t.background_image+")"),t.background_transparency&&""!==t.background_transparency&&(i.opacity=parseInt(t.background_transparency,10)/100),t.background_type&&""!==t.background_type)switch(t.background_type){case"tile":i.backgroundRepeat="repeat";break;case"center":i.backgroundRepeat="no-repeat";break;case"stretch":i.backgroundSize="100%",i.backgroundRepeat="no-repeat";break;case"cover":i.backgroundSize="cover",i.backgroundRepeat="no-repeat";break;case"contain":i.backgroundSize="contain",i.backgroundRepeat="no-repeat"}t.background_position&&""!==t.background_position&&(i.backgroundPosition=t.background_position.replace("_"," "));var d=[];for(var c in i)i.hasOwnProperty(c)&&d.push(c.replace(/([A-Z])/g,function(t,i,e,s){return"-"+t.toLowerCase()})+":"+i[c]+";");return d.join("")},p.prototype.getContainerClassName=function(){var t=[u+g,u+g+"--id-"+this.id,u+g+"--index-"+this.index];return this.isTeaser&&t.push(u+g+"--teaser"),void 0!==this.data.config.settings.height&&""!==this.data.config.settings.height&&t.push(u+g+"--fixed-height"),void 0!==this.data.config.settings.width&&"fixed"!=this.data.config.settings.width&&t.push(u+g+"--fixed-width"),void 0!==this.data.config.settings.position&&""!==this.data.config.settings.position&&t.push(u+g+"--position-"+this.data.config.settings.position.replace("_","-")),void 0!==this.data.config.settings.shadow&&1==this.data.config.settings.shadow&&t.push(u+g+"--shadow"),void 0!==this.data.config.settings.overlay&&1==this.data.config.settings.overlay&&t.push(u+g+"--overlay"),t.join(" ")},p.prototype.paint=function(t){var i=this.frameDocument.querySelector("section-"+this.id+"-style");null!==i&&i.parentNode.removeChild(i);this.campaign.data.layout.desktop.base_color;var e=this.campaign.data.layout.desktop.text_color,s=this.campaign.data.layout.desktop.overwrite,n=this.campaign.data.layout.desktop.font_family;s&&0!==parseInt(s,10)&&""!==s||!this.utility.devices.mobile||(this.campaign.data.layout.mobile.base_color,e=this.campaign.data.layout.mobile.text_color,n=this.campaign.data.layout.mobile.font_family),n&&""!==n&&(t.style.fontFamily=n);var a=[];if(e&&""!==e&&a.push(["."+u+g+"--id-"+this.id+",","."+u+g+"--id-"+this.id+" input,","."+u+g+"--id-"+this.id+" label {","color:"+e+";","}"].join("")),void 0!==this.data.config&&void 0!==this.data.config.settings&&void 0!==this.data.config.settings.default_text_color&&void 0!==this.data.config.settings.text_color&&""!=this.data.config.settings.text_color&&0==this.data.config.settings.default_text_color&&a.push(["."+u+g+"--id-"+this.id+" h1,","."+u+g+"--id-"+this.id+" h1 div,","."+u+g+"--id-"+this.id+" h2,","."+u+g+"--id-"+this.id+" h2 div,","."+u+g+"--id-"+this.id+" h3,","."+u+g+"--id-"+this.id+" h3 div,","."+u+g+"--id-"+this.id+" h4,","."+u+g+"--id-"+this.id+" h4 div,","."+u+g+"--id-"+this.id+" h5,","."+u+g+"--id-"+this.id+" h5 div,","."+u+g+"--id-"+this.id+" h6,","."+u+g+"--id-"+this.id+" h6 div,","."+u+g+"--id-"+this.id+" p,","."+u+g+"--id-"+this.id+" p div {","color:"+this.data.config.settings.text_color+" !important;","}"].join("")),0<a.length){var o=document.createElement("style");o.id="section-"+this.id+"-style",o.innerHTML=a.join(""),this.frameDocument.body.appendChild(o)}},p.prototype.preloadNode=function(t,i){function e(){0===--a&&setTimeout(function(){i(s,n)},1)}var s=this.getImagesFromNode(t),n=this.getFontsFromNode(t),a=s.length+n.length;if(0<a){if(0<s.length){var o;for(var r in s)s.hasOwnProperty(r)&&((o=new Image).onload=o.onabort=o.onerror=e,o.src=s[r],this.imagesPreloaded.push(s[r]));o=null}if(0<n.length){var d;for(var c in n)if(n.hasOwnProperty(c)){var h=n[c].replace(/"/gi,"").replace(/ /gi,"+").replace(/\\/gi,"");(d=document.createElement("link")).rel="stylesheet",d.type="text/css",d.href="https://fonts.googleapis.com/css?family="+h+":300,300i,400,400i,500,500i,600,600i,700,700i",d.setAttribute("data-font",h),d.onload=d.onabort=d.onerror=e,this.frameDocument.head.appendChild(d)}d=null}}else i(s,n)},p.prototype.getImagesFromNode=function(t){var i=[];if(t.style.backgroundImage&&""!==t.style.backgroundImage){var e=t.style.backgroundImage.match(/\((.*?)\)/);null!==e&&e[1]&&(e=e[1].replace(/('|")/g,""))&&""!==e&&-1===i.indexOf(e)&&-1===this.imagesPreloaded.indexOf(e)&&i.push(e)}else"img"===t.nodeName.toLowerCase()&&-1===i.indexOf(t.src)&&-1===this.imagesPreloaded.indexOf(t.src)&&i.push(t.src);if(t.childNodes&&0<t.childNodes.length)for(var s,n=0,a=t.childNodes.length;n<a;n++)if(1===(s=t.childNodes[n]).nodeType){var o=this.getImagesFromNode(s);if(0<o.length)for(var r in o)o.hasOwnProperty(r)&&-1===i.indexOf(o[r])&&i.push(o[r])}return i},p.prototype.getFontsFromNode=function(t,i){if(i=i||[],t.style.fontFamily&&""!==t.style.fontFamily&&-1===i.indexOf(t.style.fontFamily)&&null===this.frameDocument.head.querySelector('link[data-font="'+t.style.fontFamily.replace(/"/gi,"").replace(/ /gi,"+")+'"]')&&i.push(t.style.fontFamily.replace(/'/gi,"")),t.childNodes&&0<t.childNodes.length)for(var e,s=0,n=t.childNodes.length;s<n;s++)1===(e=t.childNodes[s]).nodeType&&this.getFontsFromNode(e,i);return i},p.prototype.getImagesFromObject=function(t,i){var e=(typeof t).toLowerCase();if("string"===e)this.getImagesFromString(t,i);else if("object"===e&&null!==t)if(void 0!==t.length)for(var s=0,n=t.length;s<n;s++)this.getImagesFromObject(t[s],i);else for(var a in t)t.hasOwnProperty(a)&&this.getImagesFromObject(t[a],i)},p.prototype.getFontsFromObject=function(t,i){var e=(typeof t).toLowerCase();if("string"===e)this.getFontsFromString(t,i);else if("object"===e&&null!==t)if(void 0!==t.length)for(var s=0,n=t.length;s<n;s++)this.getFontsFromObject(t[s],i);else for(var a in t)t.hasOwnProperty(a)&&this.getFontsFromObject(t[a],i)},p.prototype.getImagesFromString=function(t,i){for(var e=/(https?:\/\/.*\/files\/.*.(jpeg|png|gif|jpg))/gim;null!==(m=e.exec(t));)m.index===e.lastIndex&&e.lastIndex++,m&&m[0]&&-1===i.indexOf(m[0])&&-1===this.imagesPreloaded.indexOf(m[0])&&i.push(m[0])},p.prototype.processNode=function(t){if(0<this.directives.length)for(var i=0,e=this.directives.length;i<e;i++){var s=t.querySelectorAll(this.directives[i].selector);if(s&&0<s.length)for(var n=0,a=s.length;n<a;n++)void 0===s[n]["__directive_"+this.directives[i].alias]&&(s[n]["__directive_"+this.directives[i].alias]=new this.directives[i].directive(s[n],this.campaign,this))}},p.prototype.destroy=function(){if(null!==this.actionTimer&&(clearTimeout(this.actionTimer),this.actionTimer=null),this.shown&&this.container&&this.frame&&this.frameContainer){var t=this.container.childNodes[0];this.data.config.settings.transition&&this.data.config.settings.transition.leave&&""!==this.data.config.settings.transition.leave?t.className+=" "+u+"animation--transition-"+this.data.config.settings.transition.leave+"-leave":t.className+=" "+u+"animation--transition-none-leave",this.campaign.popup.bindOnce(t,v(),this.destroyTransitionEnd.bind(this)),setTimeout(function(){this.data.config.settings.transition&&this.data.config.settings.transition.leave&&""!==this.data.config.settings.transition.leave?t.classList.add(u+"animation--transition-"+this.data.config.settings.transition.leave+"-leave-active"):t.classList.add(u+"animation--transition-none-leave-active")}.bind(this),10)}this.shown=!1},p.prototype.enterTransitionEnd=function(){this.campaign.disableNextSection=!1;var t=this.container.childNodes[0];this.data.config.settings.transition&&this.data.config.settings.transition.enter&&""!==this.data.config.settings.transition.enter?t.classList.remove(u+"animation--transition-"+this.data.config.settings.transition.enter+"-enter",u+"animation--transition-"+this.data.config.settings.transition.enter+"-enter-active"):t.classList.remove(u+"animation--transition-none-enter",u+"animation--transition-none-enter-active")},p.prototype.destroyTransitionEnd=function(){this.container.parentNode.parentNode.removeChild(this.container.parentNode),this.onResizeFrame()},p.prototype.callDirectiveMethod=function(t,i,e){if(void 0!==i){for(var s in i)void 0!==s&&0===s.indexOf("__directive_")&&void 0!==i[s][t]&&(e?e(i[s][t]()):i[s][t]());if(i.childNodes&&0<i.childNodes.length)for(var n=0,a=i.childNodes.length;n<a;n++)1===i.childNodes[n].nodeType&&this.callDirectiveMethod(t,i.childNodes[n],e)}},p.prototype.cookHTML=function(t){var i=document.createElement("div");i.innerHTML=t;var e=document.createDocumentFragment();if(0<i.childNodes.length)for(;0<i.childNodes.length;)e.appendChild(i.childNodes[0]);return i=null,e},p.prototype.getBodyClass=function(){var t=["site","site--disallow-mobile-style"];return this.utility.devices.mobile?(t.push("device-category--mobile"),t.push("category-mobile"),t.push("site--mobile")):this.utility.devices.tablet?(t.push("device-category--tablet"),t.push("category-tablet"),t.push("site--tablet")):(t.push("device-category--desktop"),t.push("category-desktop"),t.push("site--desktop")),this.utility.devices.ipad?(t.push("device-type--ipad"),t.push("device-os-version--"+(this.utility.devices.iOSversion+"").replace(/\./gi,"-"))):this.utility.devices.iphone?(t.push("device-type--iphone"),t.push("device-os-version--"+(this.utility.devices.iOSversion+"").replace(/\./gi,"-"))):this.utility.devices.android&&(t.push("device-type--android"),t.push("device-os-version--"+(this.utility.devices.iOSversion+"").replace(/\./gi,"-"))),this.utility.devices.android_tablet?t.push("device-type--android-tablet"):this.utility.devices.android_phone?t.push("device-type--android-phone"):this.utility.devices.windows_phone&&t.push("device-type--windows-phone"),t.join(" ")},p.prototype.getWindowHeight=function(){return void 0!==window.game_popup_container?window.game_popup_container.offsetHeight:window.innerHeight},p.prototype.getWindowWidth=function(){return void 0!==window.game_popup_container?window.game_popup_container.offsetWidth:window.innerWidth},p.prototype.getFontsFromString=function(t,i){for(var e=/font-family: ?([^;]*);/gim;null!==(m=e.exec(t));)if(m.index===e.lastIndex&&e.lastIndex++,m&&m[1]){var s=m[1].replace(/\'/gi,"").replace(/"/g,"").replace(/, /g,",");-1!==s.indexOf(",")&&(s=(s=s.split(","))[0]),-1===i.indexOf(s)&&null===this.frameDocument.head.querySelector('link[data-font="'+s.replace(/"/gi,"").replace(/ /gi,"+")+'"]')&&i.push(s)}},p.prototype.getSize=function(){var t=this.container.parentNode;this.setTransform(t.style,"none"),this.container.offsetWidth;var i=this.container.offsetWidth,e=this.container.offsetHeight;1!=this.data.config.settings.shadow||this.utility.devices.mobile||(i+=40,e+=40);var s=parseInt(this.data.config.settings.margin_right,10),n=parseInt(this.data.config.settings.margin_left,10);if(isNaN(s)&&(s=0),isNaN(n)&&(n=0),this.data.config.settings.close&&1==this.data.config.settings.close.enabled){var a=parseInt(this.data.config.settings.close.offset.x,10);switch(void 0===this.data.config.settings.close.position&&(this.data.config.settings.close.position="top_right"),this.data.config.settings.close.position){case"top_left":!isNaN(a)&&a<0&&(n+=Math.abs(a));break;case"top_right":!isNaN(a)&&0<a&&(s+=a)}}if(this.data.config.settings.margin_top&&""!==this.data.config.settings.margin_top&&(e+=parseInt(this.data.config.settings.margin_top,10)),i+=s,this.data.config.settings.margin_bottom&&""!==this.data.config.settings.margin_bottom&&(e+=parseInt(this.data.config.settings.margin_bottom,10)),i+=n,this.data.config.settings.close&&1==this.data.config.settings.close.enabled){a=parseInt(this.data.config.settings.close.offset.x,10);var o=parseInt(this.data.config.settings.close.offset.y,10);!isNaN(a)&&0<a&&(i+=a),!isNaN(o)&&o<0&&(e+=Math.abs(o))}var r=this.getWindowWidth(),d=this.getWindowHeight();return 1==this.data.config.settings.overlay&&(i=r,e<d&&(e=d)),{width:i,height:e}},p.prototype.setTransform=function(t,i){t.webkitTransform=t.MozTransform=t.msTransform=t.OTransform=t.transform=i},p.prototype.setStyle=function(t,i){var e=[];for(var s in t)t.hasOwnProperty(s)&&e.push(s.replace(/([A-Z])/g,"-$1").toLowerCase()+":"+t[s]+" !important;");i.style.cssText+=e.join("")},p.prototype.onCloseClick=function(t){t.stopPropagation(),this.campaign.didClose=!0;var i=this.campaign.conditions&&this.campaign.conditions.settings&&1==this.campaign.conditions.settings.remove_teaser_when_popup_close;this.callDirectiveMethod("onCloseClick",this.container),i||this.campaign.iterateSectionConditions(0)===this.index||this.campaign.storage.ended?(i&&(this.campaign.storage.ended=1,this.campaign.storage.ended_due_to="remove_teaser_when_popup_close",this.campaign.storage.ended_on=(new Date).getTime(),this.campaign.saveStorage()),this.destroy()):(this.destroy(),this.campaign.render(0))},b.prototype.onCloseClick=function(){this.campaign.utility.createCookie("force_show",JSON.stringify({campaign_id:this.campaign.campaign_id,section:0}),30,"/")},_.prototype.receiveMessage=function(t){t.data&&"leadfamly-game-ready"==t.data&&(this.iframe.className+=" iframe-element-addon-element--ready")},y.prototype.receiveMessage=function(t){if(t.data&&"leadfamly-game-ready"==t.data&&null!==this.iframe)this.firstResize?this.runReadyAfterFirstResize=!0:this.iframe.className+=" iframe-games-addon-element--ready";else if(t.data){var i=null;try{i=JSON.parse(t.data)}catch(t){}if(i&&i.action&&i.type&&"leadfamly-campaign"===i.type){if(i.data&&i.uri&&-1===this.settings.game_url.indexOf(i.uri))return;switch(i.action){case"resize":1==this.settings.responsive_height?100<i.data.height&&(this.lastKnownHeight=Math.max(this.minHeight,i.data.height),this.firstResize?(this.currentHeight=this.lastKnownHeight,this.container.style.height=this.currentHeight+"px",this.campaign.onResizeFrame(),this.runReadyAfterFirstResize&&(this.iframe.className+=" iframe-games-addon-element--ready",this.container.classList.add("iframe-games-addon--placeholder-remove"),this.runReadyAfterFirstResize=!1)):this._onResize(),this.firstResize=!1):this.runReadyAfterFirstResize&&(this.iframe.className+=" iframe-games-addon-element--ready",this.container.classList.add("iframe-games-addon--placeholder-remove"),this.runReadyAfterFirstResize=!1)}}}},y.prototype._onResize=function(){this.currTime=(new Date).getTime(),this.resizing||(this.resizing=!0,null!==this.resizeTimeout&&(clearTimeout(this.resizeTimeout),this.resizeTimeout=null),this.resizeAnimationFrameId=s(this._onResizeFrame)),this.resizeTimeout=setTimeout(this._onResizeEnd,375)},y.prototype._onResizeEnd=function(){this.resizing=!1,(this.resizeTimeout=null)!==this.resizeAnimationFrameId&&(e(this.resizeAnimationFrameId),this.resizeAnimationFrameId=null)},y.prototype._onResizeFrame=function(){if(this.resizing){var t=(new Date).getTime(),i=t-this.currTime;if(this.currTime=t,this.resizeAnimationFrameId=s(this._onResizeFrame),null!==this.lastKnownHeight&&0!=i&&this.lastKnownHeight!=this.currentHeight){var e=(this.lastKnownHeight-this.currentHeight)/i;0<e&&e<2?e=2:e<0&&Math.abs(e)<2&&(e=-2),this.currentHeight+=e,this.currentHeight=Math.floor(this.currentHeight),Math.abs(this.currentHeight-this.lastKnownHeight)<5&&(this.currentHeight=this.lastKnownHeight),this.container.style.height=this.currentHeight+"px",this.campaign.onResizeFrame(),this.runReadyAfterFirstResize&&(this.iframe.className+=" iframe-games-addon-element--ready",this.runReadyAfterFirstResize=!1)}}},w.prototype.buildButton=function(){var t=document.createElement("div");t.className="form-element form-element-button",this.settings.button.alignment&&""!==this.settings.button.alignment&&(t.className+=" form-element-button-alignment-"+this.settings.button.alignment);var i=document.createElement("a");return i.className="btn button button-radius-none",i.href="#next-page",i.innerHTML=this.settings.button.label&&""!==this.settings.button.label?this.settings.button.label:"Send",t.appendChild(i),t},w.prototype.paint=function(){var t=this.section.frameDocument.querySelector("section-"+this.section.id+"-registration-style");null!==t&&t.parentNode.removeChild(t);var i=this.campaign.data.layout.desktop.base_color,e=this.campaign.data.layout.desktop.text_color,s=this.campaign.data.layout.desktop.overwrite;s&&0!==parseInt(s,10)&&""!==s||!this.campaign.utility.devices.mobile||(i=this.campaign.data.layout.mobile.base_color,e=this.campaign.data.layout.mobile.text_color);var n=this.settings.appearance,a=n&&""!==n.background_color?n.background_color:"",o=n&&""!==n.placeholder_color?n.placeholder_color:e,r=n&&""!==n.stroke_color?n.stroke_color:i,d=n&&""!==n.text_color?n.text_color:e,c=[];a&&""!==a&&(c.push(["."+u+g+"--id-"+this.section.id+" .form-element-text input,","."+u+g+"--id-"+this.section.id+" .form-element-textarea textarea {","background-color:"+l(a)+" !important;","}"].join("")),c.push(["."+u+g+"--id-"+this.section.id+" .form-element-checkbox label:after {","color:"+l(a)+" !important;","}"].join("")),c.push(["."+u+g+"--id-"+this.section.id+" .form-element-select .select__selected {","background-color:"+l(a)+" !important;","}"].join(""))),o&&""!==o&&c.push(["."+u+g+"--id-"+this.section.id+" .form-element-text label,","."+u+g+"--id-"+this.section.id+" .form-element-textarea label,","."+u+g+"--id-"+this.section.id+" .form-element-paragraph .form-element-type-paragraph,","."+u+g+"--id-"+this.section.id+" .form-element-select label {","color:"+l(o)+" !important;","}"].join("")),c.push(["."+u+g+"--id-"+this.section.id+" .form-element-text input,","."+u+g+"--id-"+this.section.id+" .form-element-textarea textarea {","border-color:"+(n&&""!==n.stroke_color?l(n.stroke_color):"rgba(0,0,0,.12)")+" !important;","}"].join("")),c.push(["."+u+g+"--id-"+this.section.id+" .form-element-select .select__selected,","."+u+g+"--id-"+this.section.id+" .form-element-select label {","border-color:"+(n&&""!==n.stroke_color?l(n.stroke_color):"rgba(0,0,0,.12)")+" !important;","}"].join("")),c.push(["."+u+g+"--id-"+this.section.id+" .form-element-select label:before {","border-color: "+(n&&""!==n.stroke_color?l(n.stroke_color):"rgba(0,0,0,.12)")+" transparent transparent transparent !important;","}"].join("")),c.push(["."+u+g+"--id-"+this.section.id+" .form-element-select .select--active label:before {","border-color: transparent transparent "+(n&&""!==n.stroke_color?l(n.stroke_color):"rgba(0,0,0,.12)")+" transparent !important;","}"].join("")),c.push(["."+u+g+"--id-"+this.section.id+" .text-field:after {","background-color:"+l(r)+" !important;","}"].join("")),c.push(["."+u+g+"--id-"+this.section.id+" .form-element-checkbox label:before,","."+u+g+"--id-"+this.section.id+" .form-element-checkbox label:after {","border-color:"+(n&&""!==n.stroke_color?l(n.stroke_color):"rgba(0,0,0,.12)")+" !important;","}"].join("")),c.push(["."+u+g+"--id-"+this.section.id+" .form-element-checkbox label:after {","background-color:"+l(r)+" !important;","}"].join("")),c.push(["."+u+g+"--id-"+this.section.id+" .form-element-radio .radio__item-label:before {","border-color:"+l(r)+" !important;","}"].join("")),c.push(["."+u+g+"--id-"+this.section.id+" .form-element-radio .radio__item-label:after {","background-color:"+l(r)+" !important;","}"].join("")),d&&""!==d&&(c.push(["."+u+g+"--id-"+this.section.id+" .form-element-text input,","."+u+g+"--id-"+this.section.id+" .form-element-textarea textarea {","color:"+l(d)+" !important;","}"].join("")),c.push(["."+u+g+"--id-"+this.section.id+" .form-element-select .select__selected {","color:"+l(d)+" !important;","}"].join("")),c.push(["."+u+g+"--id-"+this.section.id+" .form-element-select:before {","border-color:"+l(d)+" !important;","}"].join("")),c.push(["."+u+g+"--id-"+this.section.id+" .form-element-checkbox label {","color:"+l(d)+" !important;","}"].join("")),c.push(["."+u+g+"--id-"+this.section.id+" .form-element-radio label {","color:"+l(d)+" !important;","}"].join("")));var h=document.createElement("style");h.id="section-"+this.section.id+"-registration-style",h.innerHTML=c.join(""),this.section.frameDocument.body.appendChild(h)},w.prototype.buildField=function(t){t.input_type=t.input_type||"text",t.alias=t.alias||"";var i=document.createElement("div");i.className="form-element form-element-"+t.input_type,void 0===t.visible||t.visible||(i.style.display="none"),this.settings.appearance&&this.settings.appearance.input_style&&""!==this.settings.appearance.input_style&&(i.className+=" form-element--style-"+this.settings.appearance.input_style.replace("_","-"));var e,s=document.createElement("div");switch(s.className="content-form-element-"+t.id+" form-element-type form-element-type-"+t.input_type,t.input_type){case"text":e=new x(t,this.node,this.campaign,this.section),this.fields.push(e),s.appendChild(e.render());break;case"textarea":e=new N(t,this.node,this.campaign,this.section),this.fields.push(e),s.appendChild(e.render());break;case"hidden":return e=new k(t,this.node,this.campaign,this.section),this.fields.push(e),e.render();case"checkbox":e=new C(t,this.node,this.campaign,this.section),this.fields.push(e),s.appendChild(e.render());break;case"paragraph":e=new T(t,this.node,this.campaign,this.section),this.fields.push(e),s.appendChild(e.render());break;case"select":e=new I(t,this.node,this.campaign,this.section),this.fields.push(e),s.appendChild(e.render());break;case"radio":e=new F(t,this.node,this.campaign,this.section),this.fields.push(e),s.appendChild(e.render())}return i.appendChild(s),i},w.prototype.validate=function(){var e=!0,s={};0<this.fields.length&&this.fields.forEach(function(t){t.validate()||(e=!1);var i=t.serialize();!1!==i&&(s[i.name]=i.value)});var t=this.campaign.getSectionByIndex(this.campaign.sectionIndex);return e&&t&&(s.won=1,s.desktop=this.campaign.utility.devices.desktop?"1":"0",s.tablet=this.campaign.utility.devices.tablet?"1":"0",s.mobile=this.campaign.utility.devices.mobile?"1":"0",s.page=t.id,this.campaign.utility.post(t.config.settings.addons.registration.settings.endpoint,s,function(t){},"registration"),this.campaign.formularDidSubmit=!0),e},k.prototype.render=function(){var t=document.createElement("input");return t.type="hidden",t.className="hidden-field__input",t.name=this.field.id,t.value=this.field.value,t.autocomplete="off",t.id="field-"+this.field.id,t},k.prototype.validate=function(){return!0},k.prototype.serialize=function(){return{name:this.field.id,value:this.field.value}},x.prototype.render=function(){var t=document.createElement("div");if(t.className="text-field",this.field.required&&1==this.field.required&&(t.className+=" text-field--required"),this.settings.appearance&&""!==this.settings.appearance.background_color&&(t.className+=" text-field--background"),this.field.label&&""!==this.field.label){var i=document.createElement("label");i.className="text-field__label",i.innerHTML=this.field.label.replace(/&#60;/gi,"<").replace(/&#62;/gi,">"),i.setAttribute("for","field-"+this.field.id),t.appendChild(i)}var e=document.createElement("input");return"email"==this.field.type?e.type="email":e.type="text",e.className="text-field__input",e.name=this.field.id,e.value=void 0!==this.field.default_value&&""!=this.field.default_value?this.field.default_value:this.field.value,e.autocomplete="off",e.id="field-"+this.field.id,""==this.field.visible&&(t.style.display="none"),this.campaign.popup.bind(e,"keyup",this.onChange),this.campaign.popup.bind(e,"keypress",this.onChange),this.campaign.popup.bind(e,"keydown",this.onChange),this.campaign.popup.bind(e,"focus",this.onFocus),this.campaign.popup.bind(e,"blur",this.onBlur),this.inputNode=e,t.appendChild(e),this.node=t,this.onChange(),t},x.prototype.onChange=function(){""!==this.inputNode.value?(this.node.classList.add("text-field--not-empty"),this.node.classList.remove("text-field--empty")):(this.node.classList.add("text-field--empty"),this.node.classList.remove("text-field--not-empty"))},x.prototype.onFocus=function(){this.node.classList.add("text-field--focus")},x.prototype.onBlur=function(){this.node.classList.remove("text-field--focus")},x.prototype.validate=function(){return this.node.classList.remove("text-field--error"),this.node&&this.inputNode&&this.field.required&&1==this.field.required&&(""===this.node.value||!this.inputNode.value)?(this.node.classList.add("text-field--error"),!1):this.node&&this.inputNode&&""!==this.inputNode.value&&"email"==this.inputNode.type&&!/^[a-zA-Z0-9.!#$%&*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-\.]+)$/.test(this.inputNode.value)?(this.node.classList.add("text-field--error"),!1):!(this.node&&this.inputNode&&""!==this.inputNode.value&&this.field&&this.field.type&&"phonenumber"==this.field.type&&!/^(\s?\d{2}\s?\d{2}\s?\d{2}\s?\d{2})$/.test(this.inputNode.value))||(this.node.classList.add("text-field--error"),!1)},x.prototype.serialize=function(){return{name:this.inputNode.name,value:this.inputNode.value}},N.prototype.render=function(){var t=document.createElement("div");if(t.className="text-field",this.field.required&&1==this.field.required&&(t.className+=" text-field--required"),this.settings.appearance&&""!==this.settings.appearance.background_color&&(t.className+=" text-field--background"),this.field.label&&""!==this.field.label){var i=document.createElement("label");i.className="text-field__label",i.innerHTML=this.field.label.replace(/&#60;/gi,"<").replace(/&#62;/gi,">"),i.setAttribute("for","field-"+this.field.id),t.appendChild(i)}var e=document.createElement("textarea");return e.className="text-field__input",e.name=this.field.id,e.value=void 0!==this.field.default_value&&""!=this.field.default_value?this.field.default_value:this.field.value,e.autocomplete="off",e.id="field-"+this.field.id,""==this.field.visible&&(t.style.display="none"),this.campaign.popup.bind(e,"keyup",this.onChange),this.campaign.popup.bind(e,"keypress",this.onChange),this.campaign.popup.bind(e,"keydown",this.onChange),this.campaign.popup.bind(e,"focus",this.onFocus),this.campaign.popup.bind(e,"blur",this.onBlur),this.inputNode=e,t.appendChild(e),this.node=t,this.onChange(),t},N.prototype.onChange=function(){""!==this.inputNode.value?(this.node.classList.add("text-field--not-empty"),this.node.classList.remove("text-field--empty")):(this.node.classList.add("text-field--empty"),this.node.classList.remove("text-field--not-empty"))},N.prototype.onFocus=function(){this.node.classList.add("text-field--focus")},N.prototype.onBlur=function(){this.node.classList.remove("text-field--focus")},N.prototype.validate=function(){return this.node.classList.remove("text-field--error"),this.node&&this.inputNode&&this.field.required&&1==this.field.required&&(""===this.node.value||!this.inputNode.value)?(this.node.classList.add("text-field--error"),!1):!(this.node&&this.inputNode&&""!==this.inputNode.value&&"email"==this.inputNode.type&&!/^[a-zA-Z0-9.!#$%&*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-\.]+)$/.test(this.inputNode.value))||(this.node.classList.add("text-field--error"),!1)},N.prototype.serialize=function(){return{name:this.inputNode.name,value:this.inputNode.value}},C.prototype.render=function(){var t=document.createElement("div");t.className="checkbox",this.field.required&&1==this.field.required&&(t.className+=" checkbox--required");var i=document.createElement("input");i.type="checkbox",i.className="checkbox__input",i.name=this.field.id,i.value=this.field.value,i.id="field-"+this.field.id,void 0!==this.field.default_value&&""!=this.field.default_value&&(i.checked=!0),this.campaign.popup.bind(i,"focus",this.onFocus),this.campaign.popup.bind(i,"blur",this.onBlur),this.inputNode=i,t.appendChild(i);var e=document.createElement("label");return e.className="checkbox__label",e.innerHTML=this.field.label.replace(/&#60;/gi,"<").replace(/&#62;/gi,">"),e.setAttribute("for","field-"+this.field.id),t.appendChild(e),this.node=t,""==this.field.visible&&(t.style.display="none"),t},C.prototype.onBlur=function(){this.node.classList.remove("checkbox--focus")},C.prototype.onFocus=function(){this.node.classList.add("checkbox--focus")},C.prototype.validate=function(){return this.node.classList.remove("checkbox--error"),!(this.node&&this.inputNode&&this.field.required&&1==this.field.required&&!this.inputNode.checked)||(this.node.classList.add("checkbox--error"),!1)},C.prototype.serialize=function(){return{name:this.inputNode.name,value:this.inputNode.checked?"1":"0"}},T.prototype.render=function(){return document.createTextNode(this.field.label.replace(/&#60;/gi,"<").replace(/&#62;/gi,">"))},T.prototype.validate=function(){return!0},T.prototype.serialize=function(){return!1},I.prototype.render=function(){var t=document.createElement("div");t.className="select",this.selectFieldNode=t,this.field.required&&1==this.field.required&&(t.className+=" select--required");var i=document.createElement("div");i.className="select__selected",this.campaign.popup.bind(i,"click",this.onSelectedClick),this.selectSelectedNode=i;var e=document.createElement("div");e.className="select__options";var s=document.createElement("select");s.className="select__input",s.name=this.field.id,s.value=this.field.value,s.id="field-"+this.field.id,this.campaign.popup.bind(s,"change",this.onChange);var n=document.createElement("option");if(n.innerHTML="",n.value="",n.disabled=!0,n.selected=!0,s.appendChild(n),void 0!==this.field.options&&0<this.field.options.length)for(var a=0,o=this.field.options.length;a<o;a++){var r=document.createElement("option");r.value=this.field.options[a],r.innerHTML=this.field.options[a],s.appendChild(r),(r=document.createElement("div")).className="select__options-option",r.innerHTML=this.field.options[a],r.setAttribute("data-index",a+1),this.campaign.popup.bind(r,"click",this.onOptionClick.bind(this,r)),e.appendChild(r)}this.selectNode=s,t.appendChild(s),t.appendChild(i),t.appendChild(e);var d=document.createElement("label");return d.className="select__label",d.innerHTML=this.field.label.replace(/&#60;/gi,"<").replace(/&#62;/gi,">"),d.setAttribute("for","field-"+this.field.id),this.campaign.popup.bind(d,"click",this.onSelectedClick),t.appendChild(d),this.node=t,this.onChange(),t},I.prototype.onChange=function(){var t="",i=this.selectNode.options[this.selectNode.selectedIndex];!0!==i.disabled&&(t=this.selectNode.options[this.selectNode.selectedIndex].innerHTML),!0!==i.disabled?(this.selectFieldNode.classList.remove("select--empty"),this.selectFieldNode.classList.add("select--not-empty")):(this.selectFieldNode.classList.remove("select--not-empty"),this.selectFieldNode.classList.add("select--empty")),this.selectSelectedNode.innerHTML=t},I.prototype.onOptionClick=function(t){var i=parseInt(t.getAttribute("data-index"),10);this.selectNode.selectedIndex=i,this.onChange(),this.selectFieldNode.classList.remove("select--active")},I.prototype.onSelectedClick=function(){this.selectFieldNode.classList.contains("select--active")?this.selectFieldNode.classList.remove("select--active"):this.selectFieldNode.classList.add("select--active")},I.prototype.validate=function(){this.node.classList.remove("select--error");var t=this.selectNode.options[this.selectNode.selectedIndex];return!(this.node&&this.selectNode&&this.field.required&&1==this.field.required&&!1!==t.disabled)||(this.node.classList.add("select--error"),!1)},I.prototype.serialize=function(){return{name:this.selectNode.name,value:this.selectNode.options[this.selectNode.selectedIndex].value}},F.prototype.render=function(){var t=document.createElement("div");t.className="radio";var i=document.createElement("label");if(i.className="radio__label",i.innerHTML=this.field.label.replace(/&#60;/gi,"<").replace(/&#62;/gi,">"),t.appendChild(i),void 0!==this.field.options&&0<this.field.options.length)for(var e=0,s=this.field.options.length;e<s;e++){var n=document.createElement("div");n.className="radio__item";var a=document.createElement("input");a.type="radio",a.name=this.field.id,a.id="field-"+this.field.id+"-item-"+e,a.value=this.field.options[e],0===e&&(a.checked=!0);var o=document.createElement("label");o.className="radio__item-label",o.innerHTML=this.field.options[e].replace(/&#60;/gi,"<").replace(/&#62;/gi,">"),o.setAttribute("for","field-"+this.field.id+"-item-"+e),n.appendChild(a),n.appendChild(o),t.appendChild(n)}return this.node=t},F.prototype.validate=function(){var t=this.node.querySelectorAll('input[type="radio"]'),i=null;if(null!==t&&0<t.length)for(var e in t)t.hasOwnProperty(e)&&t[e].checked&&(i=t[e]);return this.node.classList.remove("select--error"),null!==i||!this.field.required||1!=this.field.required||(this.node.classList.add("select--error"),!1)},F.prototype.serialize=function(){var t=this.node.querySelectorAll('input[type="radio"]'),i=null;if(null!==t&&0<t.length)for(var e in t)t.hasOwnProperty(e)&&t[e].checked&&(i=t[e]);return{name:this.field.id,value:null!==i?i.value:-1}},L.prototype.onClick=function(t){var i=t.currentTarget.getAttribute("href"),e=t.currentTarget.getAttribute("target");if(i&&-1!==i.indexOf("#next-page"))t.preventDefault(),this.campaign.nextSection();else if(i&&""!==i)if(t.preventDefault(),null!=e&&""!==e)switch(e){case"_blank":window.top.open(i);break;case"_self":case"_top":window.top.location.href=i}else window.top.open(i)},L.prototype.paintOriginal=function(){this.node.style.cssText=[this.backgroundColor&&""!==this.backgroundColor?"background-color:"+this.backgroundColor+";":"",this.color&&""!==this.color?"color:"+this.color+";":"",this.borderColor&&""!==this.borderColor?"border-color:"+this.borderColor+";":"",this.padding&&""!==this.padding?"padding:"+this.padding+";":"",this.borderWidth&&""!==this.borderWidth?"border-width:"+this.borderWidth+";":""].join("")},L.prototype.paintHover=function(){this.node.style.cssText=[this.hoverBackgroundColor&&""!==this.hoverBackgroundColor?"background-color:"+this.hoverBackgroundColor+";":"",this.hoverColor&&""!==this.hoverColor?"color:"+this.hoverColor+";":"",this.hoverBorderColor&&""!==this.hoverBorderColor?"border-color:"+this.hoverBorderColor+";":"",this.padding&&""!==this.padding?"padding:"+this.padding+";":"",this.borderWidth&&""!==this.borderWidth?"border-width:"+this.borderWidth+";":""].join("")},z.prototype.loadFinish=function(t){if(t){var i=document.createDocumentFragment(),e=document.createElement("div");for(var s in e.className="raptor__items",this.data){if(this.data.hasOwnProperty(s)&&void 0!==this.data[s].ProductUrl&&""!=this.data[s].ProductUrl){var n=document.createElement("div");switch(n.className="raptor__item column fourth center equal-padding",this.items_to_show){case 4:n.className="raptor__item column fourth center equal-padding";break;case 2:n.className="raptor__item column half center equal-padding";break;case 1:n.className="raptor__item column center equal-padding"}var a=document.createElement("a");if(a.setAttribute("href",this.data[s].ProductUrl),a.setAttribute("target","_blank"),void 0!==this.data[s].content&&0<this.data[s].content.length)for(var o in this.data[s].content)if(this.data[s].content.hasOwnProperty(o)&&void 0!==this.data[s].content[o].content&&""!=this.data[s].content[o].content&&void 0!==this.data[s].content[o].type&&""!=this.data[s].content[o].type){var r=null;switch(this.data[s].content[o].type){case"h1":(r=document.createElement("h1")).innerHTML=this.data[s].content[o].content;break;case"h2":(r=document.createElement("h2")).innerHTML=this.data[s].content[o].content;break;case"h3":(r=document.createElement("h3")).innerHTML=this.data[s].content[o].content;break;case"h4":(r=document.createElement("h4")).innerHTML=this.data[s].content[o].content;break;case"h5":(r=document.createElement("h5")).innerHTML=this.data[s].content[o].content;break;case"h6":(r=document.createElement("h6")).innerHTML=this.data[s].content[o].content;break;case"content":(r=document.createElement("p")).innerHTML=this.data[s].content[o].content;break;case"image":(r=document.createElement("div")).className="image center";var d=new Image;d.src=this.data[s].content[o].content,r.appendChild(d)}null!==r&&a.appendChild(r)}n.appendChild(a),e.appendChild(n)}i.appendChild(e)}this.node.append(i),this.campaign.onResizeFrame(),setTimeout(function(){this.campaign.onResizeFrame()}.bind(this))}this.throbber.classList.add("throbber--hide"),setTimeout(function(){this.throbber.style.display="none"}.bind(this),275),this.campaign.onResizeFrame()},z.prototype.load=function(){var t=this.getEmail(),i={};!1!==t&&(i.FromFeatureValue=t),this.campaign.utility.get("https://api.raptorsmartadvisor.com/v1/"+this.settings.customer_id+"/GetUserHistoryRecommendationsForAds/"+this.items_to_show+"/"+this.settings.api_key,i,function(t){if(0<t.length){var i=[];for(var e in t)t.hasOwnProperty(e)&&void 0!==t[e].ImageUrl&&""!=t[e].ImageUrl&&i.push(t[e].ImageUrl);if(0<i.length){var s=i.length+0;for(var n in i)if(i.hasOwnProperty(n)){var a=new Image;a.onload=a.onerror=a.onabort=function(){0===--s&&(this.data=this.parse(t),this.loadFinish(!0))}.bind(this),a.src=i[n]}}else this.loadFinish(!1)}}.bind(this))},z.prototype.getEmail=function(){var t=this.campaign.utility.getPostHistory("registration");if(null!==t&&void 0!==t.parameters&&void 0!==this.campaign.data&&void 0!==this.campaign.data.sections&&0<this.campaign.data.sections.length){var i=0;for(var e in this.campaign.data.sections)if(this.campaign.data.sections.hasOwnProperty(e)&&void 0!==this.campaign.data.sections[e].config&&void 0!==this.campaign.data.sections[e].config.settings&&void 0!==this.campaign.data.sections[e].config.settings.addons&&void 0!==this.campaign.data.sections[e].config.settings.addons.registration&&void 0!==this.campaign.data.sections[e].config.settings.addons.registration.settings&&void 0!==this.campaign.data.sections[e].config.settings.addons.registration.settings.fields&&0<this.campaign.data.sections[e].config.settings.addons.registration.settings.fields.length)for(var s in this.campaign.data.sections[e].config.settings.addons.registration.settings.fields)this.campaign.data.sections[e].config.settings.addons.registration.settings.fields.hasOwnProperty(s)&&"email"===this.campaign.data.sections[e].config.settings.addons.registration.settings.fields[s].type&&(i=this.campaign.data.sections[e].config.settings.addons.registration.settings.fields[s].id);if(void 0!==t.parameters[i]&&""!=t.parameters[i])return t.parameters[i]}return!1},z.prototype.buildContent=function(t){var i=[];if(void 0!==this.settings.fields&&0<Object.keys(this.settings.fields).length)for(var e in this.settings.fields)if(this.settings.fields.hasOwnProperty(e)&&void 0!==this.settings.fields[e].field&&""!=this.settings.fields[e].field&&void 0!==t[this.settings.fields[e].field]&&""!=t[this.settings.fields[e].field]){var s="p";switch(this.settings.fields[e].display){case"h1":s="h1";break;case"h2":s="h2";break;case"h3":s="h3";break;case"h4":s="h4";break;case"h5":s="h5";break;case"h6":s="h6";break;case"image":s="image"}i.push({type:s,content:t[this.settings.fields[e].field]})}return i},z.prototype.parse=function(t){if(t&&0<t.length)for(var i in t)t.hasOwnProperty(i)&&(t[i].content=this.buildContent(t[i]));return t},O.prototype.ready=function(){if(this.isTesting=null!==document.querySelector(".booztit-edit-sections")&&-1!==window.location.href.indexOf("token:"),this.isTesting||(document.addEventListener("focusin",function(t){if(null!==t.target){var i=t.target.nodeName.toLowerCase();if(-1!==["select","input"].indexOf(i)&&this.campaigns&&0<this.campaigns.length)for(var e in this.campaigns)this.campaigns.hasOwnProperty(e)&&this.campaigns[e].onInputFocus()}}.bind(this)),document.addEventListener("focusout",function(t){var i=t.target.nodeName.toLowerCase();if(-1!==["select","input"].indexOf(i)&&this.campaigns&&0<this.campaigns.length)for(var e in this.campaigns)this.campaigns.hasOwnProperty(e)&&this.campaigns[e].onInputBlur()}.bind(this))),this.utility=d.popup_utility,void 0!==d.leadfamly_games_popup)for(var t in d.leadfamly_games_popup)d.leadfamly_games_popup.hasOwnProperty(t)&&this.customers.push(parseInt(d.leadfamly_games_popup[t],10));this.onResize=this.onResize.bind(this),this.onResizeEnd=this.onResizeEnd.bind(this),this.onResizeFrame=this.onResizeFrame.bind(this),this.onHashChange=this.onHashChange.bind(this),this.bind(window,"resize",this.onResize),this.bind(window,"orientationchange",this.onResize),this.isTesting||this.fetchCustomers(function(){this.bind(window,"hashchange",this.onHashChange)}.bind(this)),void 0!==d.games_popup_ready&&d.games_popup_ready()},O.prototype.onHashChange=function(){this.recheckCampaigns()},O.prototype.recheckCampaigns=function(){if(this.campaigns&&0<this.campaigns.length)for(var t in this.campaigns)this.campaigns.hasOwnProperty(t)&&this.checkCampaign(this.campaigns[t])},O.prototype.onResize=function(){this.resizing||(this.resizing=!0,null!==this.resizeTimeout&&(clearTimeout(this.resizeTimeout),this.resizeTimeout=null),this.resizeAnimationFrameId=s(this.onResizeFrame)),this.resizeTimeout=setTimeout(this.onResizeEnd,375)},O.prototype.onResizeEnd=function(){this.resizing=!1,(this.resizeTimeout=null)!==this.resizeAnimationFrameId&&(e(this.resizeAnimationFrameId),this.resizeAnimationFrameId=null)},O.prototype.onResizeFrame=function(){if(this.resizing){if(this.campaigns&&0<this.campaigns.length)for(var t in this.campaigns)this.campaigns.hasOwnProperty(t)&&this.campaigns[t].onResizeFrame();this.resizeAnimationFrameId=s(this.onResizeFrame)}},O.prototype.test=function(t,i,e){this.utility||(this.utility=d.popup_utility),void 0!==e&&(this.utility.devices.mobile=this.utility.devices.android=this.utility.devices.android_phone=e,this.utility.devices.desktop=!e);var s=null;0<this.campaigns.length&&this.campaigns.forEach(function(t){t.campaign_id==i&&(s=t)}),null===s&&(this.campaigns.push(new h(t,i,{},{},this)),s=this.campaigns[this.campaigns.length-1]),s.destroy(),s.getLongData(function(){this.showCampaignPopup(s)}.bind(this))},O.prototype.fetchCustomers=function(t){if(0<this.customers.length){function i(){0===--e&&t()}var e=this.customers.length;for(var s in this.customers)this.customers.hasOwnProperty(s)&&this.fetchCustomer(this.customers[s],i)}else t()},O.prototype.fetchCustomer=function(i,e){this.utility.fetchJson(c+"/cache/campaign/popup/customer_"+i+".json?r="+Math.floor(Math.floor((new Date).getTime()/1e3)/86400),function(t){this.checkCustomerData(i,t,e)}.bind(this))},O.prototype.checkCustomerData=function(t,i,e){if(0<Object.keys(i).length){var s=0;for(var n in i)i.hasOwnProperty(n)&&s++;function a(){0===--s&&e()}for(var o in i)i.hasOwnProperty(o)&&(o=parseInt(o,10),this.campaigns.push(new h(t,o,null,i[o],this)),this.checkCampaign(this.campaigns[this.campaigns.length-1],a))}else e()},O.prototype.checkCampaign=function(h,g){g=g||null,this.utility.getCookie("force_show",function(c){if(null!==c)try{c=JSON.parse(c)}catch(t){c=!1}else c=!1;h.getStorage(function(t){var i=!1;if(h.data.settings.campaign&&void 0!==h.data.settings.campaign.active&&(i=1==h.data.settings.campaign.active),i&&h.data.settings.campaign&&h.data.settings.campaign.active_from&&h.data.settings.campaign.active_to){var e=-1!==h.data.settings.campaign.active_from.indexOf("-")||"number"!=(typeof h.data.settings.campaign.active_from).toLowerCase()&&isNaN(parseInt(h.data.settings.campaign.active_from))?this.utility.dateParse(h.data.settings.campaign.active_from).getTime():1e3*parseInt(h.data.settings.campaign.active_from),s=-1!==h.data.settings.campaign.active_to.indexOf("-")||"number"!=(typeof h.data.settings.campaign.active_to).toLowerCase()&&isNaN(parseInt(h.data.settings.campaign.active_to))?this.utility.dateParse(h.data.settings.campaign.active_to).getTime():1e3*parseInt(h.data.settings.campaign.active_to),n=(new Date).getTime();e<=n&&n<=s||(i=!1)}this.info(h.campaign_id+")","model:",h);var a=this.utility.checkConditions(h.campaign_id,t,{active:i,devices:h.data.settings.devices,schedule:h.data.settings.schedule,default_display:h.data.settings.conditions.default_display,show_count:h.data.settings.conditions.show_count,time_interval_visits:h.data.settings.conditions.time_interval_visits,rules:h.data.rules&&h.data.rules.rules?h.data.rules.rules:null},!1);!1!==c&&h.campaign_id==c.campaign_id&&(a=!0,h.storage.activeSection=c.section);var o=1==h.data.settings.dont_hide_popup_after_signup;if(!a||t.ended&&(!o||"remove_teaser_when_popup_close"==t.ended_due_to)||h.didClose||!this.isTesting&&-1!==this.isShowingCampaigns.indexOf(h.campaign_id))this.isTesting||-1===this.isShowingCampaigns.indexOf(h.campaign_id)||a&&!t.ended||(this.isShowingCampaigns.splice(this.isShowingCampaigns.indexOf(h.campaign_id),1),h.destroy()),null!==g&&g();else{var r=h.conditions.settings.conditions.trigger||"pageload";!this.isTesting&&this.isShowingCampaigns.indexOf(h.campaign_id)&&this.isShowingCampaigns.push(h.campaign_id);var d=function(){h.saveStorage();var t=(new Date).getTime();h.getLongData(function(){this.showCampaignPopup(h,t),null!==g&&g()}.bind(this))}.bind(this);"pageload"===r?d():"scroll"===r?this.bindOnce(window,"scroll",function(){d()}):"exit_intent"===r?this.bindExitIntent(function(){d()}):null!==g&&g()}}.bind(this))}.bind(this))},O.prototype.bindExitIntent=function(e){setTimeout(function(){var i=function(t){t.clientY<0&&(e(),this.unbind(document,"mouseleave",i))}.bind(this);this.bind(document,"mouseleave",i)}.bind(this),4e3)},O.prototype.showCampaignPopup=function(t,i){i=i||(new Date).getTime();var e=t.conditions&&t.conditions.settings&&t.conditions.settings.conditions?t.conditions.settings.conditions:null,s=null!==e&&"pageload"===e.trigger?parseInt(t.conditions.settings.conditions.delay,10):0;setTimeout(function(){t.render(void 0!==t.storage.activeSection?parseInt(t.storage.activeSection,10):0)},Math.max(0,1e3*s-((new Date).getTime()-i)))},O.prototype.bind=function(t,i,e){t.addEventListener(i,e,!1)},O.prototype.bindOnce=function(i,e,s){var n=function(t){s(t),this.unbind(i,e,n)}.bind(this);i.addEventListener(e,n,!1)},O.prototype.unbind=function(t,i,e){t.removeEventListener(i,e,!1)},O.prototype.destroy=function(){0<this.campaigns.length&&this.campaigns.forEach(function(t){t.destroy()}),this.frame&&(this.frame.parentNode.removeChild(this.frame),this.frameDocument=this.frameContainer=this.frameWindow=null,this.frameLoading=!1,this.frameLoadingCallback=[])},O.prototype.info=function(){var t=Array.prototype.slice.call(arguments);0<t.length&&(t.unshift("color: black; background-color: turquoise; padding: 3px 5px;"),t.unshift("%c[Info]"),this.logs.push(t))},O.prototype.error=function(){var t=Array.prototype.slice.call(arguments);0<t.length&&(t.unshift("color: red; background-color: black; padding: 3px 5px;"),t.unshift("%c[Error]"),this.logs.push(t))},O.prototype.success=function(){var t=Array.prototype.slice.call(arguments);0<t.length&&(t.unshift("color: white; background-color: limeGreen; padding: 3px 5px;"),t.unshift("%c[Success]"),this.logs.push(t))},O.prototype.debug=function(){this.logs.forEach(function(t){console.log.apply(console.log,t)})},d.games_popup_instance=new O,d.popup_utility.init(c,d.games_popup_instance.ready.bind(d.games_popup_instance)))}(window);